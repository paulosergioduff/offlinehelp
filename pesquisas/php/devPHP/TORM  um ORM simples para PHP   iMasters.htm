<!DOCTYPE html>
<html lang="pt-br"><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta charset="utf-8"><title>TORM: um ORM simples para PHP | iMasters</title><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="shortcut icon" type="image/png" href="https://imasters.com.br/favicon.png"><link rel="apple-touch-icon" href="https://imasters.com.br/favicon.png"><meta data-react-helmet="true" name="description" content="Eustáquio conta como foi criar um ORMs em PHP que suprisse as suas necessidades para desenvolver um projeto utilizando PHP puro."><meta data-react-helmet="true" property="og:url" content="https://imasters.com.br/back-end/torm-um-orm-simples-para-php"><meta data-react-helmet="true" property="og:locale" content="pt_BR"><meta data-react-helmet="true" property="og:type" content="article"><meta data-react-helmet="true" property="og:title" content="TORM: um ORM simples para PHP - iMasters - We are Developers"><meta data-react-helmet="true" property="og:description" content="Eustáquio conta como foi criar um ORMs em PHP que suprisse as suas necessidades para desenvolver um projeto utilizando PHP puro."><meta data-react-helmet="true" property="og:site_name" content="iMasters - We are Developers"><meta data-react-helmet="true" property="article:published_time" content="2013-10-10T09:00:36-03:00"><meta data-react-helmet="true" property="article:modified_time" content="2018-05-23T22:43:14-03:00"><meta data-react-helmet="true" property="og:updated_time" content="2018-05-23T22:43:14-03:00"><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" name="twitter:description" content="Eustáquio conta como foi criar um ORMs em PHP que suprisse as suas necessidades para desenvolver um projeto utilizando PHP puro."><meta data-react-helmet="true" name="twitter:title" content="TORM: um ORM simples para PHP - iMasters - We are Developers"><link data-react-helmet="true" rel="canonical" href="TORM%20%20um%20ORM%20simples%20para%20PHP%20%20%20iMasters_arquivos/torm-um-orm-simples-para-php.htm"><!-- Global site tag (gtag.js) - Google Analytics --><script src="TORM%20%20um%20ORM%20simples%20para%20PHP%20%20%20iMasters_arquivos/osd.js"></script><script src="TORM%20%20um%20ORM%20simples%20para%20PHP%20%20%20iMasters_arquivos/pubads_impl_rendering_215.js"></script><script type="text/javascript" async="" src="TORM%20%20um%20ORM%20simples%20para%20PHP%20%20%20iMasters_arquivos/analytics.js"></script><script id="facebook-jssdk" async="" src="TORM%20%20um%20ORM%20simples%20para%20PHP%20%20%20iMasters_arquivos/sdk.js"></script><script async="" type="text/javascript" src="TORM%20%20um%20ORM%20simples%20para%20PHP%20%20%20iMasters_arquivos/gpt.js"></script><script async="" src="TORM%20%20um%20ORM%20simples%20para%20PHP%20%20%20iMasters_arquivos/js"></script><script>window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-31855766-1');</script><!-- BEGIN GOOGLE DFP --><script>var googletag = googletag || {};
      googletag.cmd = googletag.cmd || [];

      (function() {
        var gads = document.createElement('script');
        gads.async = true;
        gads.type = 'text/javascript';
        var useSSL = 'https:' == document.location.protocol;
        gads.src = (useSSL ? 'https:' : 'http:') +
        '//www.googletagservices.com/tag/js/gpt.js';
        var node = document.getElementsByTagName('script')[0];
        node.parentNode.insertBefore(gads, node);
      })();

      googletag.cmd.push(function() {
        googletag.defineSlot('/12730173/Topo_Super', [728, 90], 'div-gpt-ad-1344653865581-0').addService(googletag.pubads());
        googletag.pubads().enableSingleRequest();
        googletag.enableServices();
      });

      googletag.cmd.push(function() {
        googletag.defineSlot('/12730173/Rodape_Super', [728, 90], 'div-gpt-ad-1346273022262-0').addService(googletag.pubads());
        googletag.pubads().enableSingleRequest();
        googletag.enableServices();
      });

    googletag.cmd.push(function() {
      googletag.defineSlot('/12730173/Lateral_Arroba', [300, 250], 'div-gpt-ad-1361751716353-0').addService(googletag.pubads());
      googletag.pubads().enableSingleRequest();
      googletag.enableServices();
    });

    googletag.cmd.push(function() {
      googletag.defineSlot('/12730173/Lateral_Arroba2', [300, 250], 'div-gpt-ad-1361751813796-0').addService(googletag.pubads());
      googletag.pubads().enableSingleRequest();
      googletag.enableServices();
    });</script><!-- END GOOGLE DFP --><link rel="stylesheet" href="TORM%20%20um%20ORM%20simples%20para%20PHP%20%20%20iMasters_arquivos/main.css" async=""><style type="text/css"></style><script async="" type="text/javascript">
      googletag.cmd.push(function() {
        googletag.display('div-gpt-ad-1344653865581-0');
      })
    </script><link rel="preload" href="TORM%20%20um%20ORM%20simples%20para%20PHP%20%20%20iMasters_arquivos/integrator_002.js" as="script"><script type="text/javascript" src="TORM%20%20um%20ORM%20simples%20para%20PHP%20%20%20iMasters_arquivos/integrator_002.js"></script><link rel="preload" href="TORM%20%20um%20ORM%20simples%20para%20PHP%20%20%20iMasters_arquivos/integrator.js" as="script"><script type="text/javascript" src="TORM%20%20um%20ORM%20simples%20para%20PHP%20%20%20iMasters_arquivos/integrator.js"></script><script src="TORM%20%20um%20ORM%20simples%20para%20PHP%20%20%20iMasters_arquivos/pubads_impl_215.js" async=""></script><style type="text/css">.fb_hidden{position:absolute;top:-10000px;z-index:10001}.fb_reposition{overflow:hidden;position:relative}.fb_invisible{display:none}.fb_reset{background:none;border:0;border-spacing:0;color:#000;cursor:auto;direction:ltr;font-family:"lucida grande", tahoma, verdana, arial, sans-serif;font-size:11px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:1;margin:0;overflow:visible;padding:0;text-align:left;text-decoration:none;text-indent:0;text-shadow:none;text-transform:none;visibility:visible;white-space:normal;word-spacing:normal}.fb_reset>div{overflow:hidden}.fb_link img{border:none}@keyframes fb_transform{from{opacity:0;transform:scale(.95)}to{opacity:1;transform:scale(1)}}.fb_animate{animation:fb_transform .3s forwards}
.fb_dialog{background:rgba(82, 82, 82, .7);position:absolute;top:-10000px;z-index:10001}.fb_reset .fb_dialog_legacy{overflow:visible}.fb_dialog_advanced{padding:10px;border-radius:8px}.fb_dialog_content{background:#fff;color:#333}.fb_dialog_close_icon{background:url(https://z-p3-static.xx.fbcdn.net/rsrc.php/v3/yq/r/IE9JII6Z1Ys.png) no-repeat scroll 0 0 transparent;cursor:pointer;display:block;height:15px;position:absolute;right:18px;top:17px;width:15px}.fb_dialog_mobile .fb_dialog_close_icon{top:5px;left:5px;right:auto}.fb_dialog_padding{background-color:transparent;position:absolute;width:1px;z-index:-1}.fb_dialog_close_icon:hover{background:url(https://z-p3-static.xx.fbcdn.net/rsrc.php/v3/yq/r/IE9JII6Z1Ys.png) no-repeat scroll 0 -15px transparent}.fb_dialog_close_icon:active{background:url(https://z-p3-static.xx.fbcdn.net/rsrc.php/v3/yq/r/IE9JII6Z1Ys.png) no-repeat scroll 0 -30px transparent}.fb_dialog_loader{background-color:#f6f7f9;border:1px solid #606060;font-size:24px;padding:20px}.fb_dialog_top_left,.fb_dialog_top_right,.fb_dialog_bottom_left,.fb_dialog_bottom_right{height:10px;width:10px;overflow:hidden;position:absolute}.fb_dialog_top_left{background:url(https://z-p3-static.xx.fbcdn.net/rsrc.php/v3/ye/r/8YeTNIlTZjm.png) no-repeat 0 0;left:-10px;top:-10px}.fb_dialog_top_right{background:url(https://z-p3-static.xx.fbcdn.net/rsrc.php/v3/ye/r/8YeTNIlTZjm.png) no-repeat 0 -10px;right:-10px;top:-10px}.fb_dialog_bottom_left{background:url(https://z-p3-static.xx.fbcdn.net/rsrc.php/v3/ye/r/8YeTNIlTZjm.png) no-repeat 0 -20px;bottom:-10px;left:-10px}.fb_dialog_bottom_right{background:url(https://z-p3-static.xx.fbcdn.net/rsrc.php/v3/ye/r/8YeTNIlTZjm.png) no-repeat 0 -30px;right:-10px;bottom:-10px}.fb_dialog_vert_left,.fb_dialog_vert_right,.fb_dialog_horiz_top,.fb_dialog_horiz_bottom{position:absolute;background:#525252;filter:alpha(opacity=70);opacity:.7}.fb_dialog_vert_left,.fb_dialog_vert_right{width:10px;height:100%}.fb_dialog_vert_left{margin-left:-10px}.fb_dialog_vert_right{right:0;margin-right:-10px}.fb_dialog_horiz_top,.fb_dialog_horiz_bottom{width:100%;height:10px}.fb_dialog_horiz_top{margin-top:-10px}.fb_dialog_horiz_bottom{bottom:0;margin-bottom:-10px}.fb_dialog_iframe{line-height:0}.fb_dialog_content .dialog_title{background:#6d84b4;border:1px solid #365899;color:#fff;font-size:14px;font-weight:bold;margin:0}.fb_dialog_content .dialog_title>span{background:url(https://z-p3-static.xx.fbcdn.net/rsrc.php/v3/yd/r/Cou7n-nqK52.gif) no-repeat 5px 50%;float:left;padding:5px 0 7px 26px}body.fb_hidden{-webkit-transform:none;height:100%;margin:0;overflow:visible;position:absolute;top:-10000px;left:0;width:100%}.fb_dialog.fb_dialog_mobile.loading{background:url(https://z-p3-static.xx.fbcdn.net/rsrc.php/v3/ya/r/3rhSv5V8j3o.gif) white no-repeat 50% 50%;min-height:100%;min-width:100%;overflow:hidden;position:absolute;top:0;z-index:10001}.fb_dialog.fb_dialog_mobile.loading.centered{width:auto;height:auto;min-height:initial;min-width:initial;background:none}.fb_dialog.fb_dialog_mobile.loading.centered #fb_dialog_loader_spinner{width:100%}.fb_dialog.fb_dialog_mobile.loading.centered .fb_dialog_content{background:none}.loading.centered #fb_dialog_loader_close{color:#fff;display:block;padding-top:20px;clear:both;font-size:18px}#fb-root #fb_dialog_ipad_overlay{background:rgba(0, 0, 0, .45);position:absolute;bottom:0;left:0;right:0;top:0;width:100%;min-height:100%;z-index:10000}#fb-root #fb_dialog_ipad_overlay.hidden{display:none}.fb_dialog.fb_dialog_mobile.loading iframe{visibility:hidden}.fb_dialog_content .dialog_header{-webkit-box-shadow:white 0 1px 1px -1px inset;background:-webkit-gradient(linear, 0% 0%, 0% 100%, from(#738ABA), to(#2C4987));border-bottom:1px solid;border-color:#1d4088;color:#fff;font:14px Helvetica, sans-serif;font-weight:bold;text-overflow:ellipsis;text-shadow:rgba(0, 30, 84, .296875) 0 -1px 0;vertical-align:middle;white-space:nowrap}.fb_dialog_content .dialog_header table{-webkit-font-smoothing:subpixel-antialiased;height:43px;width:100%}.fb_dialog_content .dialog_header td.header_left{font-size:12px;padding-left:5px;vertical-align:middle;width:60px}.fb_dialog_content .dialog_header td.header_right{font-size:12px;padding-right:5px;vertical-align:middle;width:60px}.fb_dialog_content .touchable_button{background:-webkit-gradient(linear, 0% 0%, 0% 100%, from(#4966A6), color-stop(.5, #355492), to(#2A4887));border:1px solid #29487d;-webkit-background-clip:padding-box;-webkit-border-radius:3px;-webkit-box-shadow:rgba(0, 0, 0, .117188) 0 1px 1px inset, rgba(255, 255, 255, .167969) 0 1px 0;display:inline-block;margin-top:3px;max-width:85px;line-height:18px;padding:4px 12px;position:relative}.fb_dialog_content .dialog_header .touchable_button input{border:none;background:none;color:#fff;font:12px Helvetica, sans-serif;font-weight:bold;margin:2px -12px;padding:2px 6px 3px 6px;text-shadow:rgba(0, 30, 84, .296875) 0 -1px 0}.fb_dialog_content .dialog_header .header_center{color:#fff;font-size:16px;font-weight:bold;line-height:18px;text-align:center;vertical-align:middle}.fb_dialog_content .dialog_content{background:url(https://z-p3-static.xx.fbcdn.net/rsrc.php/v3/y9/r/jKEcVPZFk-2.gif) no-repeat 50% 50%;border:1px solid #555;border-bottom:0;border-top:0;height:150px}.fb_dialog_content .dialog_footer{background:#f6f7f9;border:1px solid #555;border-top-color:#ccc;height:40px}#fb_dialog_loader_close{float:left}.fb_dialog.fb_dialog_mobile .fb_dialog_close_button{text-shadow:rgba(0, 30, 84, .296875) 0 -1px 0}.fb_dialog.fb_dialog_mobile .fb_dialog_close_icon{visibility:hidden}#fb_dialog_loader_spinner{animation:rotateSpinner 1.2s linear infinite;background-color:transparent;background-image:url(https://z-p3-static.xx.fbcdn.net/rsrc.php/v3/yD/r/t-wz8gw1xG1.png);background-repeat:no-repeat;background-position:50% 50%;height:24px;width:24px}@keyframes rotateSpinner{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}
.fb_iframe_widget{display:inline-block;position:relative}.fb_iframe_widget span{display:inline-block;position:relative;text-align:justify}.fb_iframe_widget iframe{position:absolute}.fb_iframe_widget_fluid_desktop,.fb_iframe_widget_fluid_desktop span,.fb_iframe_widget_fluid_desktop iframe{max-width:100%}.fb_iframe_widget_fluid_desktop iframe{min-width:220px;position:relative}.fb_iframe_widget_lift{z-index:1}.fb_hide_iframes iframe{position:relative;left:-10000px}.fb_iframe_widget_loader{position:relative;display:inline-block}.fb_iframe_widget_fluid{display:inline}.fb_iframe_widget_fluid span{width:100%}.fb_iframe_widget_loader iframe{min-height:32px;z-index:2;zoom:1}.fb_iframe_widget_loader .FB_Loader{background:url(https://z-p3-static.xx.fbcdn.net/rsrc.php/v3/y9/r/jKEcVPZFk-2.gif) no-repeat;height:32px;width:32px;margin-left:-16px;position:absolute;left:50%;z-index:4}
.fb_customer_chat_bounce_in_v1{animation-duration:250ms;animation-name:fb_bounce_in_v1}.fb_customer_chat_bounce_out_v1{animation-duration:250ms;animation-name:fb_bounce_out_v1}.fb_customer_chat_bounce_in_v2{animation-duration:300ms;animation-name:fb_bounce_in_v2;transition-timing-function:ease-in}.fb_customer_chat_bounce_out_v2{animation-duration:300ms;animation-name:fb_bounce_out_v2;transition-timing-function:ease-in}.fb_customer_chat_bounce_in_v2_mobile_chat_started{animation-duration:300ms;animation-name:fb_bounce_in_v2_mobile_chat_started;transition-timing-function:ease-in}.fb_customer_chat_bounce_out_v2_mobile_chat_started{animation-duration:300ms;animation-name:fb_bounce_out_v2_mobile_chat_started;transition-timing-function:ease-in}.fb_customer_chat_bubble_pop_in{animation-duration:250ms;animation-name:fb_customer_chat_bubble_bounce_in_animation}.fb_customer_chat_bubble_animated_no_badge{box-shadow:0 3px 12px rgba(0, 0, 0, .15);transition:box-shadow 150ms linear}.fb_customer_chat_bubble_animated_no_badge:hover{box-shadow:0 5px 24px rgba(0, 0, 0, .3)}.fb_customer_chat_bubble_animated_with_badge{box-shadow:-5px 4px 14px rgba(0, 0, 0, .15);transition:box-shadow 150ms linear}.fb_customer_chat_bubble_animated_with_badge:hover{box-shadow:-5px 8px 24px rgba(0, 0, 0, .2)}.fb_invisible_flow{display:inherit;height:0;overflow-x:hidden;width:0}.fb_mobile_overlay_active{background-color:#fff;height:100%;overflow:hidden;position:fixed;visibility:hidden;width:100%}@keyframes fb_bounce_in_v1{0%{opacity:0;transform:scale(.8, .8);transform-origin:bottom right}80%{opacity:.8;transform:scale(1.03, 1.03)}100%{opacity:1;transform:scale(1, 1)}}@keyframes fb_bounce_in_v2{0%{opacity:0;transform:scale(0, 0);transform-origin:bottom right}50%{transform:scale(1.03, 1.03);transform-origin:bottom right}100%{opacity:1;transform:scale(1, 1);transform-origin:bottom right}}@keyframes fb_bounce_in_v2_mobile_chat_started{0%{opacity:0;top:20px}100%{opacity:1;top:0}}@keyframes fb_bounce_out_v1{from{opacity:1}to{opacity:0}}@keyframes fb_bounce_out_v2{0%{opacity:1;transform:scale(1, 1);transform-origin:bottom right}100%{opacity:0;transform:scale(0, 0);transform-origin:bottom right}}@keyframes fb_bounce_out_v2_mobile_chat_started{0%{opacity:1;top:0}100%{opacity:0;top:20px}}@keyframes fb_customer_chat_bubble_bounce_in_animation{0%{bottom:6pt;opacity:0;transform:scale(0, 0);transform-origin:center}70%{bottom:18pt;opacity:1;transform:scale(1.2, 1.2)}100%{transform:scale(1, 1)}}</style></head><body><div data-js="app"><main data-reactroot=""><div id="main-app"><div class="article"><header class="header header--desktop"><div class="header__top"><div class="container"><div class="tag-line"><span class="tag-line__symbol"></span><p class="tag-line__label">we are developers</p></div><nav class="navigation"><ul class="menu"><li class="menu__item"><a href="https://eventos.imasters.com.br/" target="_blank" title="Eventos">Eventos</a></li><li class="menu__item"><a href="https://forum.imasters.com.br/" target="_blank" title="Fórum iMasters">Fórum iMasters</a></li><li class="menu__item"><a href="https://imasters.shop/" target="_blank" title="Developer Store">Developer Store</a></li><li class="menu__item"><a href="https://www.alura.com.br/imasters" target="_blank" title="Cursos Online">Cursos Online</a></li><li class="menu__item"><a href="https://setemasters.imasters.com.br/" target="_self" title="7Masters">7Masters</a></li><li class="menu__item"><a href="https://issuu.com/imasters/docs/imasters_26_v6_isuu" target="_self" title="Revista Impressa">Revista Impressa</a></li><li class="menu__item"><a href="http://certificacao.imasters.com.br/" target="_self" title="Certificações">Certificações</a></li></ul></nav></div></div><div class="header__main"><div class="container"><div class="header__actions"><div class="search"><button class="search__button"><span class="icon icon--search "><svg width="17px" height="17px" viewBox="0 0 30 30"><title>Em desenvolvimento</title><path fill="currentColor" d="M22.764 20.643l6.797 6.797c0.586 0.586 0.586 1.536 0 2.121s-1.536 0.586-2.121 0l-6.797-6.797c-2.171 1.713-4.912 2.736-7.893 2.736-7.042 0-12.75-5.708-12.75-12.75s5.708-12.75 12.75-12.75c7.042 0 12.75 5.708 12.75 12.75 0 2.98-1.023 5.722-2.736 7.893zM19.74 19.548c1.708-1.756 2.76-4.154 2.76-6.798 0-5.385-4.365-9.75-9.75-9.75s-9.75 4.365-9.75 9.75c0 5.385 4.365 9.75 9.75 9.75 2.644 0 5.041-1.052 6.798-2.76 0.029-0.034 0.059-0.068 0.092-0.1s0.066-0.063 0.1-0.092z"></path></svg></span></button><div class="search__window"><div class="search__header"><div class="container-medium"><div class="branding"><img src="TORM%20%20um%20ORM%20simples%20para%20PHP%20%20%20iMasters_arquivos/imasters-logo-white.png" alt="iMaster Developers"></div><button class="search__close"><span class="icon icon--close-circle "><svg width="24px" height="24px" viewBox="0 0 30 30"><title>close-circle</title><path fill="currentColor" d="M16.928 15l3.127 3.127c0.533 0.533 0.533 1.396 0 1.928s-1.396 0.533-1.928 0l-3.127-3.127-3.127 3.127c-0.533 0.533-1.396 0.533-1.928 0s-0.533-1.396 0-1.928l3.127-3.127-3.127-3.127c-0.533-0.533-0.533-1.396 0-1.928s1.396-0.533 1.928 0l3.127 3.127 3.127-3.127c0.533-0.533 1.396-0.533 1.928 0s0.533 1.396 0 1.928l-3.127 3.127zM15 30c-8.284 0-15-6.716-15-15s6.716-15 15-15c8.284 0 15 6.716 15 15s-6.716 15-15 15zM15 27.273c6.778 0 12.273-5.495 12.273-12.273s-5.495-12.273-12.273-12.273c-6.778 0-12.273 5.495-12.273 12.273s5.495 12.273 12.273 12.273z"></path></svg></span></button></div></div><div class="container"><div class="search-form"><div class="search-form__field"><label class="search-form__label">Digite sua palavra-chave</label><input class="search-form__input" placeholder="O que você procura?" type="text"></div><button type="submit" class="search-form__submit"><span class="icon icon--search "><svg width="17px" height="17px" viewBox="0 0 30 30"><title>Em desenvolvimento</title><path fill="currentColor" d="M22.764 20.643l6.797 6.797c0.586 0.586 0.586 1.536 0 2.121s-1.536 0.586-2.121 0l-6.797-6.797c-2.171 1.713-4.912 2.736-7.893 2.736-7.042 0-12.75-5.708-12.75-12.75s5.708-12.75 12.75-12.75c7.042 0 12.75 5.708 12.75 12.75 0 2.98-1.023 5.722-2.736 7.893zM19.74 19.548c1.708-1.756 2.76-4.154 2.76-6.798 0-5.385-4.365-9.75-9.75-9.75s-9.75 4.365-9.75 9.75c0 5.385 4.365 9.75 9.75 9.75 2.644 0 5.041-1.052 6.798-2.76 0.029-0.034 0.059-0.068 0.092-0.1s0.066-0.063 0.1-0.092z"></path></svg></span></button></div></div></div></div><h1 class="branding"><a href="https://imasters.com.br/"><img src="TORM%20%20um%20ORM%20simples%20para%20PHP%20%20%20iMasters_arquivos/imasters-logo.png" alt="iMaster Developers"></a><span class="branding__label">Powered by:</span><a href="https://dev.elo.com.br/" class="elo sponsor"><img src="TORM%20%20um%20ORM%20simples%20para%20PHP%20%20%20iMasters_arquivos/elo-logo.png" alt="elo"></a><a href="https://www.ifood.com.br/" class="ifood sponsor"><img src="TORM%20%20um%20ORM%20simples%20para%20PHP%20%20%20iMasters_arquivos/ifood-logo.png" alt="ifood"></a><a href="https://movile.com/#/careers" class="movile sponsor"><img src="TORM%20%20um%20ORM%20simples%20para%20PHP%20%20%20iMasters_arquivos/movile-logo.png" alt="movile"></a></h1><div class="social"><ul class="social-media"><li class="social-media__item social-media__item--facebook"><a href="https://www.facebook.com/PortaliMasters"><span class="icon icon--facebook "><svg width="17px" height="13px" viewBox="0 0 30 30"><title>facebook</title><path fill="currentColor" d="M16.024 30h-14.368c-0.915 0-1.656-0.742-1.656-1.656v-26.688c0-0.915 0.741-1.656 1.656-1.656h26.689c0.914 0 1.656 0.741 1.656 1.656v26.688c0 0.914-0.741 1.656-1.656 1.656h-7.645v-11.618h3.9l0.584-4.528h-4.483v-2.891c0-1.311 0.364-2.204 2.244-2.204l2.398-0.001v-4.050c-0.415-0.055-1.838-0.178-3.494-0.178-3.457 0-5.823 2.11-5.823 5.985v3.339h-3.91v4.528h3.91v11.618z"></path></svg></span></a></li><li class="social-media__item social-media__item--twitter"><a href="https://twitter.com/iMasters"><span class="icon icon--twitter "><svg width="17px" height="13px" viewBox="0 0 37 30"><title>twitter</title><path fill="currentColor" d="M36 3.551c-1.323 0.602-2.747 1.010-4.241 1.192 1.526-0.936 2.696-2.42 3.248-4.189-1.428 0.867-3.007 1.497-4.693 1.835-1.344-1.471-3.265-2.39-5.39-2.39-4.076 0-7.383 3.391-7.383 7.573 0 0.594 0.063 1.17 0.19 1.725-6.138-0.316-11.58-3.328-15.225-7.915-0.636 1.122-0.999 2.425-0.999 3.811 0 2.626 1.304 4.945 3.286 6.303-1.209-0.037-2.35-0.381-3.347-0.945v0.093c0 3.671 2.546 6.732 5.927 7.426-0.619 0.178-1.272 0.267-1.946 0.267-0.475 0-0.94-0.045-1.39-0.134 0.94 3.008 3.666 5.198 6.899 5.257-2.527 2.032-5.714 3.244-9.173 3.244-0.596 0-1.185-0.035-1.762-0.104 3.269 2.145 7.153 3.4 11.322 3.4 13.587 0 21.014-11.538 21.014-21.547 0-0.329-0.006-0.659-0.019-0.982 1.443-1.068 2.696-2.401 3.683-3.92z"></path></svg></span></a></li><li class="social-media__item social-media__item--google-plus"><a href="https://plus.google.com/+imasters"><span class="icon icon--google-plus "><svg width="17px" height="13px" viewBox="0 0 48 30"><title>google-plus</title><path fill="currentColor" d="M41.954 12.327v-5.198h-3.706v5.198h-5.337v3.713h5.337v5.347h3.706v-5.347h5.189v-3.713h-5.189zM14.973 12.030v5.941c0 0 5.753-0.008 8.095-0.008-1.268 3.851-3.241 5.948-8.095 5.948-4.912 0-8.747-3.99-8.747-8.911s3.834-8.911 8.747-8.911c2.597 0 4.275 0.915 5.813 2.189 1.232-1.234 1.129-1.41 4.262-4.374-2.66-2.426-6.195-3.904-10.076-3.904-8.269 0-14.973 6.716-14.973 15s6.704 15 14.973 15c12.36 0 15.382-10.782 14.38-17.97h-14.38z"></path></svg></span></a></li><li class="social-media__item social-media__item--linkedin"><a href="https://www.linkedin.com/groups?gid=47710"><span class="icon icon--linkedin "><svg width="17px" height="13px" viewBox="0 0 33 30"><title>linkedin</title><path fill="currentColor" d="M33 30h-7.293v-10.546c0-2.76-1.141-4.645-3.65-4.645-1.919 0-2.986 1.272-3.483 2.497-0.186 0.44-0.157 1.053-0.157 1.665v11.028h-7.226c0 0 0.093-18.682 0-20.38h7.226v3.198c0.427-1.398 2.736-3.394 6.42-3.394 4.571 0 8.163 2.931 8.163 9.244v11.332zM3.884 7.071h-0.047c-2.328 0-3.838-1.558-3.838-3.533 0-2.013 1.554-3.538 3.929-3.538 2.373 0 3.832 1.521 3.879 3.533 0 1.975-1.506 3.538-3.923 3.538v0 0zM0.832 9.62h6.432v20.38h-6.432v-20.38z"></path></svg></span></a></li></ul></div></div><div class="navigation navigation--main"><ul class="menu"><li class="menu__item"><a href="https://imasters.com.br/back-end" target="_self" title="Back-End"><span class="icon icon--package "><svg width="16px" height="16px" viewBox="0 0 28 30"><title>package</title><path fill="currentColor" d="M20.572 11.435c-0.008 0.004-0.016 0.008-0.024 0.012l-5.548 2.774v12.211l9.306-4.653c0.425-0.211 0.693-0.644 0.694-1.118v-11.44l-4.428 2.214zM10.301 4.077l9.699 4.849 3.449-1.724-9.144-4.572c-0.35-0.174-0.761-0.173-1.109-0.001l-2.895 1.448zM7.506 5.474l-3.455 1.727 9.699 4.849 3.455-1.727-9.699-4.849zM6.836 3.014c0.068-0.042 0.139-0.078 0.213-0.107l5.032-2.516c1.051-0.522 2.286-0.522 3.338 0l10 5c1.274 0.633 2.080 1.933 2.081 3.357v11.913c-0.001 1.423-0.807 2.723-2.078 3.355l-10 5c-1.056 0.529-2.3 0.529-3.356 0l-10.003-5.002c-1.273-0.641-2.072-1.949-2.063-3.366v-11.901c0.001-1.423 0.807-2.723 2.078-3.355l4.758-2.379zM12.5 26.439v-12.217l-10-5-0 11.436c-0.003 0.475 0.263 0.911 0.684 1.123l9.316 4.658z"></path></svg></span>Back-End</a></li><li class="menu__item"><a href="https://imasters.com.br/mobile" target="_self" title="Mobile"><span class="icon icon--package "><svg width="16px" height="16px" viewBox="0 0 28 30"><title>package</title><path fill="currentColor" d="M20.572 11.435c-0.008 0.004-0.016 0.008-0.024 0.012l-5.548 2.774v12.211l9.306-4.653c0.425-0.211 0.693-0.644 0.694-1.118v-11.44l-4.428 2.214zM10.301 4.077l9.699 4.849 3.449-1.724-9.144-4.572c-0.35-0.174-0.761-0.173-1.109-0.001l-2.895 1.448zM7.506 5.474l-3.455 1.727 9.699 4.849 3.455-1.727-9.699-4.849zM6.836 3.014c0.068-0.042 0.139-0.078 0.213-0.107l5.032-2.516c1.051-0.522 2.286-0.522 3.338 0l10 5c1.274 0.633 2.080 1.933 2.081 3.357v11.913c-0.001 1.423-0.807 2.723-2.078 3.355l-10 5c-1.056 0.529-2.3 0.529-3.356 0l-10.003-5.002c-1.273-0.641-2.072-1.949-2.063-3.366v-11.901c0.001-1.423 0.807-2.723 2.078-3.355l4.758-2.379zM12.5 26.439v-12.217l-10-5-0 11.436c-0.003 0.475 0.263 0.911 0.684 1.123l9.316 4.658z"></path></svg></span>Mobile</a></li><li class="menu__item"><a href="https://imasters.com.br/front-end" target="_self" title="Front End"><span class="icon icon--package "><svg width="16px" height="16px" viewBox="0 0 28 30"><title>package</title><path fill="currentColor" d="M20.572 11.435c-0.008 0.004-0.016 0.008-0.024 0.012l-5.548 2.774v12.211l9.306-4.653c0.425-0.211 0.693-0.644 0.694-1.118v-11.44l-4.428 2.214zM10.301 4.077l9.699 4.849 3.449-1.724-9.144-4.572c-0.35-0.174-0.761-0.173-1.109-0.001l-2.895 1.448zM7.506 5.474l-3.455 1.727 9.699 4.849 3.455-1.727-9.699-4.849zM6.836 3.014c0.068-0.042 0.139-0.078 0.213-0.107l5.032-2.516c1.051-0.522 2.286-0.522 3.338 0l10 5c1.274 0.633 2.080 1.933 2.081 3.357v11.913c-0.001 1.423-0.807 2.723-2.078 3.355l-10 5c-1.056 0.529-2.3 0.529-3.356 0l-10.003-5.002c-1.273-0.641-2.072-1.949-2.063-3.366v-11.901c0.001-1.423 0.807-2.723 2.078-3.355l4.758-2.379zM12.5 26.439v-12.217l-10-5-0 11.436c-0.003 0.475 0.263 0.911 0.684 1.123l9.316 4.658z"></path></svg></span>Front End</a></li><li class="menu__item"><a href="https://imasters.com.br/devsecops" target="_self" title="DevSecOps"><span class="icon icon--package "><svg width="16px" height="16px" viewBox="0 0 28 30"><title>package</title><path fill="currentColor" d="M20.572 11.435c-0.008 0.004-0.016 0.008-0.024 0.012l-5.548 2.774v12.211l9.306-4.653c0.425-0.211 0.693-0.644 0.694-1.118v-11.44l-4.428 2.214zM10.301 4.077l9.699 4.849 3.449-1.724-9.144-4.572c-0.35-0.174-0.761-0.173-1.109-0.001l-2.895 1.448zM7.506 5.474l-3.455 1.727 9.699 4.849 3.455-1.727-9.699-4.849zM6.836 3.014c0.068-0.042 0.139-0.078 0.213-0.107l5.032-2.516c1.051-0.522 2.286-0.522 3.338 0l10 5c1.274 0.633 2.080 1.933 2.081 3.357v11.913c-0.001 1.423-0.807 2.723-2.078 3.355l-10 5c-1.056 0.529-2.3 0.529-3.356 0l-10.003-5.002c-1.273-0.641-2.072-1.949-2.063-3.366v-11.901c0.001-1.423 0.807-2.723 2.078-3.355l4.758-2.379zM12.5 26.439v-12.217l-10-5-0 11.436c-0.003 0.475 0.263 0.911 0.684 1.123l9.316 4.658z"></path></svg></span>DevSecOps</a></li><li class="menu__item"><a href="https://imasters.com.br/design-ux" target="_self" title="Design &amp; UX"><span class="icon icon--package "><svg width="16px" height="16px" viewBox="0 0 28 30"><title>package</title><path fill="currentColor" d="M20.572 11.435c-0.008 0.004-0.016 0.008-0.024 0.012l-5.548 2.774v12.211l9.306-4.653c0.425-0.211 0.693-0.644 0.694-1.118v-11.44l-4.428 2.214zM10.301 4.077l9.699 4.849 3.449-1.724-9.144-4.572c-0.35-0.174-0.761-0.173-1.109-0.001l-2.895 1.448zM7.506 5.474l-3.455 1.727 9.699 4.849 3.455-1.727-9.699-4.849zM6.836 3.014c0.068-0.042 0.139-0.078 0.213-0.107l5.032-2.516c1.051-0.522 2.286-0.522 3.338 0l10 5c1.274 0.633 2.080 1.933 2.081 3.357v11.913c-0.001 1.423-0.807 2.723-2.078 3.355l-10 5c-1.056 0.529-2.3 0.529-3.356 0l-10.003-5.002c-1.273-0.641-2.072-1.949-2.063-3.366v-11.901c0.001-1.423 0.807-2.723 2.078-3.355l4.758-2.379zM12.5 26.439v-12.217l-10-5-0 11.436c-0.003 0.475 0.263 0.911 0.684 1.123l9.316 4.658z"></path></svg></span>Design &amp; UX</a></li><li class="menu__item"><a href="https://imasters.com.br/data" target="_self" title="Data"><span class="icon icon--package "><svg width="16px" height="16px" viewBox="0 0 28 30"><title>package</title><path fill="currentColor" d="M20.572 11.435c-0.008 0.004-0.016 0.008-0.024 0.012l-5.548 2.774v12.211l9.306-4.653c0.425-0.211 0.693-0.644 0.694-1.118v-11.44l-4.428 2.214zM10.301 4.077l9.699 4.849 3.449-1.724-9.144-4.572c-0.35-0.174-0.761-0.173-1.109-0.001l-2.895 1.448zM7.506 5.474l-3.455 1.727 9.699 4.849 3.455-1.727-9.699-4.849zM6.836 3.014c0.068-0.042 0.139-0.078 0.213-0.107l5.032-2.516c1.051-0.522 2.286-0.522 3.338 0l10 5c1.274 0.633 2.080 1.933 2.081 3.357v11.913c-0.001 1.423-0.807 2.723-2.078 3.355l-10 5c-1.056 0.529-2.3 0.529-3.356 0l-10.003-5.002c-1.273-0.641-2.072-1.949-2.063-3.366v-11.901c0.001-1.423 0.807-2.723 2.078-3.355l4.758-2.379zM12.5 26.439v-12.217l-10-5-0 11.436c-0.003 0.475 0.263 0.911 0.684 1.123l9.316 4.658z"></path></svg></span>Data</a></li><li class="menu__item"><a href="https://imasters.com.br/apis-microsservicos" target="_self" title="APIs e Microsserviços"><span class="icon icon--package "><svg width="16px" height="16px" viewBox="0 0 28 30"><title>package</title><path fill="currentColor" d="M20.572 11.435c-0.008 0.004-0.016 0.008-0.024 0.012l-5.548 2.774v12.211l9.306-4.653c0.425-0.211 0.693-0.644 0.694-1.118v-11.44l-4.428 2.214zM10.301 4.077l9.699 4.849 3.449-1.724-9.144-4.572c-0.35-0.174-0.761-0.173-1.109-0.001l-2.895 1.448zM7.506 5.474l-3.455 1.727 9.699 4.849 3.455-1.727-9.699-4.849zM6.836 3.014c0.068-0.042 0.139-0.078 0.213-0.107l5.032-2.516c1.051-0.522 2.286-0.522 3.338 0l10 5c1.274 0.633 2.080 1.933 2.081 3.357v11.913c-0.001 1.423-0.807 2.723-2.078 3.355l-10 5c-1.056 0.529-2.3 0.529-3.356 0l-10.003-5.002c-1.273-0.641-2.072-1.949-2.063-3.366v-11.901c0.001-1.423 0.807-2.723 2.078-3.355l4.758-2.379zM12.5 26.439v-12.217l-10-5-0 11.436c-0.003 0.475 0.263 0.911 0.684 1.123l9.316 4.658z"></path></svg></span>APIs e Microsserviços</a></li><li class="menu__item"><a href="https://imasters.com.br/iot-makers" target="_self" title="IoT e Makers"><span class="icon icon--package "><svg width="16px" height="16px" viewBox="0 0 28 30"><title>package</title><path fill="currentColor" d="M20.572 11.435c-0.008 0.004-0.016 0.008-0.024 0.012l-5.548 2.774v12.211l9.306-4.653c0.425-0.211 0.693-0.644 0.694-1.118v-11.44l-4.428 2.214zM10.301 4.077l9.699 4.849 3.449-1.724-9.144-4.572c-0.35-0.174-0.761-0.173-1.109-0.001l-2.895 1.448zM7.506 5.474l-3.455 1.727 9.699 4.849 3.455-1.727-9.699-4.849zM6.836 3.014c0.068-0.042 0.139-0.078 0.213-0.107l5.032-2.516c1.051-0.522 2.286-0.522 3.338 0l10 5c1.274 0.633 2.080 1.933 2.081 3.357v11.913c-0.001 1.423-0.807 2.723-2.078 3.355l-10 5c-1.056 0.529-2.3 0.529-3.356 0l-10.003-5.002c-1.273-0.641-2.072-1.949-2.063-3.366v-11.901c0.001-1.423 0.807-2.723 2.078-3.355l4.758-2.379zM12.5 26.439v-12.217l-10-5-0 11.436c-0.003 0.475 0.263 0.911 0.684 1.123l9.316 4.658z"></path></svg></span>IoT e Makers</a></li></ul></div></div></div></header><div></div><div class="article-header"><header class="single-header"><div class="single-header__wrap"><div class="single-header__top"><div class="container"><p>Back-End</p></div></div><div class="single-header__main"><div class="container"><div class="single-header__content"><span class="single-header__category"><a href="https://imasters.com.br/back-end" class="btn btn--primary">Back-End</a></span><h1 class="single-header__title">TORM: um ORM simples para PHP</h1><span class="single-header__date">10 out, 2013</span></div><div class="author-bio"><div class="author-bio__info"><h3 class="author-bio__name"><a href="https://imasters.com.br/perfil/eustaquio_rangel">Eustáquio Rangel</a></h3><p>Tem <a href="#">12<!-- --> artigos</a> publicados com<a href="#"> <!-- -->15192<!-- --> visualizações</a> desde <a href="#">2009</a></p></div><figure class="avatar avatar--medium"><a href="https://imasters.com.br/perfil/eustaquio_rangel" class="avatar__thumbnail-wrapper"><img src="TORM%20%20um%20ORM%20simples%20para%20PHP%20%20%20iMasters_arquivos/36a7207dc8c3974a330919128af15cc9.jpg" alt="Eustáquio Rangel" class="avatar__thumbnail"></a></figure></div></div></div></div></header><div class="ads "><div class="ads__container"><div class="ads__header"><span>Publicidade</span></div><figure class="ads__thumbnail"><div id="div-gpt-ad-1344653865581-0" data-google-query-id="CIO-1IbE1dsCFQt8wQodDkYBeQ"><div id="google_ads_iframe_/12730173/Topo_Super_0__container__" style="border: 0pt none;"><iframe id="google_ads_iframe_/12730173/Topo_Super_0" title="3rd party ad content" name="google_ads_iframe_/12730173/Topo_Super_0" scrolling="no" marginwidth="0" marginheight="0" style="border: 0px none; vertical-align: bottom;" srcdoc="" width="728" height="90" frameborder="0"></iframe></div></div></figure></div></div></div><div class="article-content"><div class="container"><aside class="sidebar sidebar--left"><div class="author-bio author-bio--plus"><figure class="avatar--has-border avatar avatar--large"><a href="https://imasters.com.br/perfil/eustaquio_rangel" class="avatar__thumbnail-wrapper"><img src="TORM%20%20um%20ORM%20simples%20para%20PHP%20%20%20iMasters_arquivos/36a7207dc8c3974a330919128af15cc9.jpg" alt="Eustáquio Rangel" class="avatar__thumbnail"></a></figure><h3 class="author-bio__name"><a href="https://imasters.com.br/perfil/eustaquio_rangel">Eustáquio Rangel</a></h3><div class="author-counters"><span class="author-counters__item"><span class="author-counters__label">12</span><span class="icon icon--edit "><svg width="15px" height="15px" viewBox="0 0 30 30"><title>edit</title><path fill="currentColor" d="M17.727 3.292l-13.636 13.636v3.526h3.526l13.636-13.636-3.526-3.526zM18.692 0.399l5.455 5.455c0.533 0.533 0.533 1.396 0 1.928l-15 15c-0.256 0.256-0.603 0.399-0.964 0.399h-5.455c-0.753 0-1.364-0.611-1.364-1.364v-5.455c0-0.362 0.144-0.709 0.399-0.964l15-15c0.533-0.533 1.396-0.533 1.928 0zM2.727 30c-0.753 0-1.364-0.611-1.364-1.364s0.611-1.364 1.364-1.364h24.545c0.753 0 1.364 0.611 1.364 1.364s-0.611 1.364-1.364 1.364h-24.545z"></path></svg></span></span></div><div class="author-bio__excerpt"><p>é desenvolvedor Java, PHP e Ruby, que é seu principal foco desde 2004 e que lhe rendeu um livro.</p><a href="https://imasters.com.br/perfil/eustaquio_rangel" class="btn">Leia mais</a></div><div class="author-recent-posts"><div class="author-recent-post"><span class="author-recent-post__date">9 nov, 2016</span><h3 class="author-recent-post__title"><a href="https://imasters.com.br/back-end/utilizando-muitas-gems-no-seu-projeto">Utilizando muitas gems no seu projeto?</a></h3></div><div class="author-recent-post"><span class="author-recent-post__date">3 set, 2015</span><h3 class="author-recent-post__title"><a href="https://imasters.com.br/devsecops/criando-volumes-encriptados-com-luks-no-gnulinux">Criando volumes encriptados com LUKS no GNU/Linux</a></h3></div><div class="author-recent-post"><span class="author-recent-post__date">19 mai, 2015</span><h3 class="author-recent-post__title"><a href="https://imasters.com.br/back-end/referencias-circulares-no-ruby-2-2-x">Referências circulares no Ruby 2.2.x</a></h3></div></div></div></aside><div class="content"><div class="the-content the-content--single"><p>Algum tempo atrás peguei um projeto em um cliente novo que não quis fazer o projeto utilizando&nbsp;<code>Rails</code>,
 por motivos que concernem apenas à ele, mas como argumentação básica 
que o time de desenvolvedores já utiliza PHP “puro” e a curva de 
aprendizado do Rails para a equipe toda seria algo que eles não 
gostariam de lidar.</p>
<p>Atualmente, nem estou trabalhando com projetos web fora do eixo 
Ruby/Rails/Sinatra, porém era um projeto interessante e resolvi topar, 
com a condição de que eu teria pelo menos um ORM em PHP para trabalhar. E
 eles concordaram.</p>
<p>Após avaliar alguns ORMs em PHP por aí, não gostei muito de nenhum, com exceção do&nbsp;<a href="http://codehappy.daylerees.com/eloquent-orm">Eloquent</a>, que para ser utilizado fora do&nbsp;<a href="http://laravel.com/">Laravel</a>&nbsp;exigia um pouco mais de ginástica e outro pacote. Então, decidi fazer o meu próprio, o&nbsp;<a href="http://taq.github.io/torm/">TORM</a>,
 que no final das contas ficou (e está ficando) bem interessante, 
tentando descaradamente copiar várias&nbsp;features&nbsp;do&nbsp;<a href="http://pt.wikipedia.org/wiki/Active_record">ActiveRecord</a>.</p>
<h2>Conectando no banco</h2>
<p>A configuração dele é simples: a parte da conexão com o banco é feita através do&nbsp;<a href="http://php.net/manual/pt_BR/book.pdo.php">PDO</a>, e tudo o que é necessário para o funcionamento está no arquivo&nbsp;<code>torm.php</code>. Vamos utilizar de exemplo o&nbsp;<a href="http://www.sqlite.org/">SQLite</a>&nbsp;(mas já tem suporte para o&nbsp;<a href="http://www.mysql.com/">MySQL</a>&nbsp;e o&nbsp;<a href="http://www.oracle.com/">Oracle</a>):</p>
<pre class="line-numbers  language-php"><code class="  language-php"><span class="token keyword">include</span> <span class="token double-quoted-string string">"torm.php"</span><span class="token punctuation">;</span>

<span class="token variable">$con</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PDO</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"sqlite:database.sqlite3"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token constant">TORM</span>\<span class="token package">Connection</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">setConnection</span><span class="token punctuation">(</span><span class="token variable">$con</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token constant">TORM</span>\<span class="token package">Connection</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">setDriver</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"sqlite"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2>Modelos</h2>
<p>Para definir os modelos é fácil: é só seguir a convenção (copiada do&nbsp;<code>ActiveRecord</code>) do nome da classe no singular ser o nome da tabela no plural (inclusive&nbsp;<a href="https://github.com/taq/torm/wiki/Models">tem até suporte para pluralizações</a>):</p>
<pre class="line-numbers  language-php"><code class="  language-php"><span class="token keyword">class</span> <span class="token class-name">User</span> <span class="token keyword">extends</span> <span class="token class-name">TORM<span class="token punctuation">\</span>Model</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">class</span> <span class="token class-name">Ticket</span> <span class="token keyword">extends</span> <span class="token class-name">TORM<span class="token punctuation">\</span>Model</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<h2>Validações</h2>
<p>Podemos especificar algumas&nbsp;<a href="https://github.com/taq/torm/wiki/validations">validações</a>&nbsp;facilmente:</p>
<pre class="line-numbers  language-php"><code class="  language-php">User<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">validates</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"name"</span><span class="token punctuation">,</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"presence"</span><span class="token operator">=</span><span class="token operator">&gt;</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
User<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">validates</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"email"</span><span class="token punctuation">,</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"presence"</span><span class="token operator">=</span><span class="token operator">&gt;</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
User<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">validates</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"email"</span><span class="token punctuation">,</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"uniqueness"</span><span class="token operator">=</span><span class="token operator">&gt;</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
User<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">validates</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"id"</span><span class="token punctuation">,</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"numericality"</span><span class="token operator">=</span><span class="token operator">&gt;</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<h2>Relacionamentos</h2>
<p>Os relacionamentos&nbsp;podem ser definidos como:</p>
<pre class="line-numbers  language-php"><code class="  language-php">User<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">hasMany</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"tickets"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
User<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">hasOne</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"account"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
Ticket<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">belongsTo</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"user"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<h2>Manipulando registros</h2>
<p>Para criar um registro novo de&nbsp;<code>User</code>:</p>
<pre class="line-numbers  language-php"><code class="  language-php"><span class="token variable">$user</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$user</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">name</span>  <span class="token operator">=</span> <span class="token double-quoted-string string">"John Doe"</span><span class="token punctuation">;</span>
<span class="token variable">$user</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">email</span> <span class="token operator">=</span> <span class="token double-quoted-string string">"john@doe.com"</span><span class="token punctuation">;</span>
<span class="token variable">$user</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">level</span> <span class="token operator">=</span> <span class="token number">1</span>
<span class="token variable">$user</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Para procurar através do id (que por convenção é a chave primária):</p>
<pre class="line-numbers  language-php"><code class="  language-php"><span class="token variable">$user</span> <span class="token operator">=</span> User<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>Para procurar todos em determinadas condições:</p>
<pre class="line-numbers  language-php"><code class="  language-php"><span class="token variable">$users</span> <span class="token operator">=</span> User<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">where</span><span class="token punctuation">(</span><span class="token keyword">array</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"level"</span><span class="token operator">=</span><span class="token operator">&gt;</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>Atualizar vários registros de uma vez:</p>
<pre class="line-numbers  language-php"><code class="  language-php">User<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">where</span><span class="token punctuation">(</span><span class="token keyword">array</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"level"</span><span class="token operator">=</span><span class="token operator">&gt;</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">updateAttributes</span><span class="token punctuation">(</span><span class="token keyword">array</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"level"</span><span class="token operator">=</span><span class="token operator">&gt;</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>Utilizar queries fluentes:</p>
<pre class="line-numbers  language-php"><code class="  language-php"><span class="token variable">$users</span> <span class="token operator">=</span> User<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">where</span><span class="token punctuation">(</span><span class="token keyword">array</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"level"</span><span class="token operator">=</span><span class="token operator">&gt;</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">limit</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">order</span><span class="token punctuation">(</span><span class="token double-quoted-string string">"name desc"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>Utilizar os relacionamentos:</p>
<pre class="line-numbers  language-php"><code class="  language-php"><span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token variable">$user</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">tickets</span> <span class="token keyword">as</span> <span class="token variable">$ticket</span><span class="token punctuation">)</span>
    <span class="token keyword">echo</span> <span class="token variable">$ticket</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">description</span><span class="token punctuation">;</span>

<span class="token keyword">echo</span> <span class="token variable">$user</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">account</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">number</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>Fora isso, ainda tem suporte à&nbsp;<a href="https://github.com/taq/torm/wiki/scopes">escopos</a>,&nbsp;<a href="https://github.com/taq/torm/wiki/Models#callbacks"><em>callbacks</em></a>,&nbsp;<a href="https://github.com/taq/torm/wiki/factories"><em>factories</em></a>,&nbsp;<a href="https://github.com/taq/torm/wiki/pagination">paginação</a>, etc. E ainda falta muita coisa que eu quero colocar por lá. Vejam a&nbsp;<a href="https://github.com/taq/torm/wiki/installing">seção de instalação</a>&nbsp;se resolverem testar o danado.</p>
<p>Se você se encontra em um projeto como esse do meu cliente, onde não pode usar&nbsp;<a href="http://rubyonrails.org/">Rails</a>&nbsp;e tem que usar&nbsp;<a href="http://php.net/">PHP</a>, pode ser que esse projeto seja de alguma valia e ajuda.</p>
</div><div class="article-content__footer"><div class="article-ranking"><img src="TORM%20%20um%20ORM%20simples%20para%20PHP%20%20%20iMasters_arquivos/owl.png" class="article-ranking__symbol"><p class="article-ranking__description">De 0 a 10, o quanto você recomendaria este artigo para um amigo?</p><div class="article-ranking__options"><button class="article-ranking__option">0</button><button class="article-ranking__option">1</button><button class="article-ranking__option">2</button><button class="article-ranking__option">3</button><button class="article-ranking__option">4</button><button class="article-ranking__option">5</button><button class="article-ranking__option">6</button><button class="article-ranking__option">7</button><button class="article-ranking__option">8</button><button class="article-ranking__option">9</button><button class="article-ranking__option">10</button></div></div></div></div><aside class="sidebar sidebar--right"><div class="related-content "><h3 class="related-content__title"><span class="icon icon--file "><svg width="18px" height="18px" viewBox="0 0 30 30"><title>file</title><path fill="currentColor" d="M24.545 12.273h-8.182c-0.753 0-1.364-0.611-1.364-1.364v-8.182h-8.182c-0.753 0-1.364 0.611-1.364 1.364v21.818c0 0.753 0.611 1.364 1.364 1.364h16.364c0.753 0 1.364-0.611 1.364-1.364v-13.636h1.364c0.753 0 1.364-0.611 1.364-1.364 0-0.188-0.038-0.368-0.107-0.531 0.071 0.173 0.107 0.35 0.107 0.531v15c0 2.259-1.832 4.091-4.091 4.091h-16.364c-2.259 0-4.091-1.832-4.091-4.091v-21.818c0-2.259 1.832-4.091 4.091-4.091h9.545c0.362 0 0.709 0.144 0.964 0.399l9.545 9.545c0.128 0.128 0.228 0.278 0.296 0.442zM17.727 4.656v4.89h4.89l-4.89-4.89z"></path></svg></span><span>Artigos publicados por este autor</span></h3><div class="related-content__list"><div class="related"><div class="related__header"><figure class="avatar"><img src="TORM%20%20um%20ORM%20simples%20para%20PHP%20%20%20iMasters_arquivos/36a7207dc8c3974a330919128af15cc9.jpg" alt="Eustáquio Rangel"></figure><div class="related__author"><h3 class="related__author-name"><a href="https://imasters.com.br/perfil/eustaquio_rangel">Eustáquio Rangel</a></h3><span class="related__date">9 nov, 2016</span><span class="icon icon--play "><svg width="18px" height="18px" viewBox="0 0 30 30"><title>play</title><path fill="currentColor" d="M6 4.25v21.505l16.726-10.753-16.726-10.753zM5.311 0.241l21 13.5c0.918 0.59 0.918 1.933 0 2.524l-21 13.5c-0.998 0.642-2.311-0.075-2.311-1.262v-27c0-1.187 1.313-1.904 2.311-1.262z"></path></svg></span></div></div><h3 class="related__title"><a href="https://imasters.com.br/back-end/utilizando-muitas-gems-no-seu-projeto">Utilizando muitas gems no seu projeto?</a></h3></div><div class="related"><div class="related__header"><figure class="avatar"><img src="TORM%20%20um%20ORM%20simples%20para%20PHP%20%20%20iMasters_arquivos/36a7207dc8c3974a330919128af15cc9.jpg" alt="Eustáquio Rangel"></figure><div class="related__author"><h3 class="related__author-name"><a href="https://imasters.com.br/perfil/eustaquio_rangel">Eustáquio Rangel</a></h3><span class="related__date">3 set, 2015</span><span class="icon icon--play "><svg width="18px" height="18px" viewBox="0 0 30 30"><title>play</title><path fill="currentColor" d="M6 4.25v21.505l16.726-10.753-16.726-10.753zM5.311 0.241l21 13.5c0.918 0.59 0.918 1.933 0 2.524l-21 13.5c-0.998 0.642-2.311-0.075-2.311-1.262v-27c0-1.187 1.313-1.904 2.311-1.262z"></path></svg></span></div></div><h3 class="related__title"><a href="https://imasters.com.br/devsecops/criando-volumes-encriptados-com-luks-no-gnulinux">Criando volumes encriptados com LUKS no GNU/Linux</a></h3></div><div class="related"><div class="related__header"><figure class="avatar"><img src="TORM%20%20um%20ORM%20simples%20para%20PHP%20%20%20iMasters_arquivos/36a7207dc8c3974a330919128af15cc9.jpg" alt="Eustáquio Rangel"></figure><div class="related__author"><h3 class="related__author-name"><a href="https://imasters.com.br/perfil/eustaquio_rangel">Eustáquio Rangel</a></h3><span class="related__date">19 mai, 2015</span><span class="icon icon--play "><svg width="18px" height="18px" viewBox="0 0 30 30"><title>play</title><path fill="currentColor" d="M6 4.25v21.505l16.726-10.753-16.726-10.753zM5.311 0.241l21 13.5c0.918 0.59 0.918 1.933 0 2.524l-21 13.5c-0.998 0.642-2.311-0.075-2.311-1.262v-27c0-1.187 1.313-1.904 2.311-1.262z"></path></svg></span></div></div><h3 class="related__title"><a href="https://imasters.com.br/back-end/referencias-circulares-no-ruby-2-2-x">Referências circulares no Ruby 2.2.x</a></h3></div><div class="related"><div class="related__header"><figure class="avatar"><img src="TORM%20%20um%20ORM%20simples%20para%20PHP%20%20%20iMasters_arquivos/36a7207dc8c3974a330919128af15cc9.jpg" alt="Eustáquio Rangel"></figure><div class="related__author"><h3 class="related__author-name"><a href="https://imasters.com.br/perfil/eustaquio_rangel">Eustáquio Rangel</a></h3><span class="related__date">13 mai, 2014</span><span class="icon icon--play "><svg width="18px" height="18px" viewBox="0 0 30 30"><title>play</title><path fill="currentColor" d="M6 4.25v21.505l16.726-10.753-16.726-10.753zM5.311 0.241l21 13.5c0.918 0.59 0.918 1.933 0 2.524l-21 13.5c-0.998 0.642-2.311-0.075-2.311-1.262v-27c0-1.187 1.313-1.904 2.311-1.262z"></path></svg></span></div></div><h3 class="related__title"><a href="https://imasters.com.br/back-end/utilizando-php-pdo-e-oracle">Utilizando PHP, PDO e Oracle</a></h3></div><div class="related"><div class="related__header"><figure class="avatar"><img src="TORM%20%20um%20ORM%20simples%20para%20PHP%20%20%20iMasters_arquivos/36a7207dc8c3974a330919128af15cc9.jpg" alt="Eustáquio Rangel"></figure><div class="related__author"><h3 class="related__author-name"><a href="https://imasters.com.br/perfil/eustaquio_rangel">Eustáquio Rangel</a></h3><span class="related__date">1 mar, 2013</span><span class="icon icon--play "><svg width="18px" height="18px" viewBox="0 0 30 30"><title>play</title><path fill="currentColor" d="M6 4.25v21.505l16.726-10.753-16.726-10.753zM5.311 0.241l21 13.5c0.918 0.59 0.918 1.933 0 2.524l-21 13.5c-0.998 0.642-2.311-0.075-2.311-1.262v-27c0-1.187 1.313-1.904 2.311-1.262z"></path></svg></span></div></div><h3 class="related__title"><a href="https://imasters.com.br/back-end/identificando-o-tipo-mime-em-ruby">Identificando o tipo MIME em Ruby</a></h3></div><div class="related"><div class="related__header"><figure class="avatar"><img src="TORM%20%20um%20ORM%20simples%20para%20PHP%20%20%20iMasters_arquivos/36a7207dc8c3974a330919128af15cc9.jpg" alt="Eustáquio Rangel"></figure><div class="related__author"><h3 class="related__author-name"><a href="https://imasters.com.br/perfil/eustaquio_rangel">Eustáquio Rangel</a></h3><span class="related__date">20 abr, 2009</span><span class="icon icon--play "><svg width="18px" height="18px" viewBox="0 0 30 30"><title>play</title><path fill="currentColor" d="M6 4.25v21.505l16.726-10.753-16.726-10.753zM5.311 0.241l21 13.5c0.918 0.59 0.918 1.933 0 2.524l-21 13.5c-0.998 0.642-2.311-0.075-2.311-1.262v-27c0-1.187 1.313-1.904 2.311-1.262z"></path></svg></span></div></div><h3 class="related__title"><a href="https://imasters.com.br/back-end/validando-xml-com-ruby">Validando XML com Ruby</a></h3></div></div></div></aside></div></div><div class="article-footer"><div class="author-about"><div class="container"><div class="author-about__box"><div class="author-about__avatar"><figure class="avatar avatar--86"><span class="avatar__thumbnail-wrapper"><img src="TORM%20%20um%20ORM%20simples%20para%20PHP%20%20%20iMasters_arquivos/36a7207dc8c3974a330919128af15cc9.jpg" alt="Eustáquio Rangel" class="avatar__thumbnail"></span></figure><a href="https://imasters.com.br/perfil/eustaquio_rangel" class="btn btn--primary">Saiba mais</a></div><div class="author-about__content"><div class="author-about__header"><h2 class="author-about__name">Eustáquio Rangel</h2><ul class="social-media"><li class="social-media__item social-media__item--linkedin"></li><li class="social-media__item social-media__item--youtube"></li><li class="social-media__item social-media__item--facebook"></li><li class="social-media__item social-media__item--twitter"></li><li class="social-media__item social-media__item--instagram"></li><li class="social-media__item social-media__item--github"></li></ul><div class="author-counters"><span class="author-counters__item"><span class="icon icon--edit "><svg width="15px" height="15px" viewBox="0 0 30 30"><title>edit</title><path fill="currentColor" d="M17.727 3.292l-13.636 13.636v3.526h3.526l13.636-13.636-3.526-3.526zM18.692 0.399l5.455 5.455c0.533 0.533 0.533 1.396 0 1.928l-15 15c-0.256 0.256-0.603 0.399-0.964 0.399h-5.455c-0.753 0-1.364-0.611-1.364-1.364v-5.455c0-0.362 0.144-0.709 0.399-0.964l15-15c0.533-0.533 1.396-0.533 1.928 0zM2.727 30c-0.753 0-1.364-0.611-1.364-1.364s0.611-1.364 1.364-1.364h24.545c0.753 0 1.364 0.611 1.364 1.364s-0.611 1.364-1.364 1.364h-24.545z"></path></svg></span><span class="author-counters__label">12<!-- --> Artigo(s)</span></span></div></div><div class="author-about__excerpt"><p>é desenvolvedor Java, PHP e Ruby, que é seu principal foco desde 2004 e que lhe rendeu um livro.</p></div></div></div></div></div><div class="article-facebook"><div><div class="fb-comments fb_iframe_widget fb_iframe_widget_fluid" data-numposts="5" data-href="https://imasters.com.br/back-end/torm-um-orm-simples-para-php" data-width="100%" data-mobile="false" fb-xfbml-state="rendered"><span style="height: 181px;"><iframe id="f1048e16a4b2a" name="f30f723d5a62e98" scrolling="no" style="border: medium none; overflow: hidden; height: 181px; width: 100%;" title="Facebook Social Plugin" class="fb_ltr" src="https://web.facebook.com/plugins/comments.php?api_key=426457214062479&amp;channel_url=https%3A%2F%2Fstaticxx.facebook.com%2Fconnect%2Fxd_arbiter%2Fr%2FmAiQUwlReIP.js%3Fversion%3D42%23cb%3Df4c48525e7ea1e%26domain%3Dimasters.com.br%26origin%3Dhttps%253A%252F%252Fimasters.com.br%252Ff2c723913f65fc4%26relation%3Dparent.parent&amp;href=https%3A%2F%2Fimasters.com.br%2Fback-end%2Ftorm-um-orm-simples-para-php&amp;locale=pt_BR&amp;mobile=false&amp;numposts=5&amp;sdk=joey&amp;version=v3.0&amp;width=100%25"></iframe></span></div></div></div></div></div><footer class="footer"><div class="maintainer"><div class="container"><div><div class="maintainer__header"><h2 class="maintainer__title">Este projeto é oferecido pelas empresas</h2></div><div class="maintainer__list"><a href="https://www.cartaoelo.com.br/" class="maintainer__item"><img src="TORM%20%20um%20ORM%20simples%20para%20PHP%20%20%20iMasters_arquivos/elo.jpg"></a><a href="https://www.linkedin.com/jobs/search/?f_C=247645&amp;#038;location=Mundialmente&amp;#038;locationId=OTHERS.worldwide&amp;#038;start=25" class="maintainer__item"><img src="TORM%20%20um%20ORM%20simples%20para%20PHP%20%20%20iMasters_arquivos/ifood.png"></a><a href="http://www.movile.com/jobs" class="maintainer__item"><img src="TORM%20%20um%20ORM%20simples%20para%20PHP%20%20%20iMasters_arquivos/movile.png"></a></div></div><div><div class="maintainer__header"><h2 class="maintainer__title">Este projeto é mantido e patrocinado pelas empresas</h2></div><div class="maintainer__list"><a href="http://developers.original.com.br/" class="maintainer__item"><img src="TORM%20%20um%20ORM%20simples%20para%20PHP%20%20%20iMasters_arquivos/banco-original-2.png"></a><a href="https://desenvolvedores.cielo.com.br/api-portal/" class="maintainer__item"><img src="TORM%20%20um%20ORM%20simples%20para%20PHP%20%20%20iMasters_arquivos/cielo-3.png"></a><a href="https://www.dialhost.com.br/?utm_campaign=patrocinio_iMasters&amp;#038;utm_source=iMasters&amp;#038;utm_medium=marca" class="maintainer__item"><img src="TORM%20%20um%20ORM%20simples%20para%20PHP%20%20%20iMasters_arquivos/dialhost-1.png"></a><a href="https://www.fiap.com.br/?utm_source=imasters&amp;#038;utm_medium=logo-rodape&amp;#038;utm_campaign=imasters2018" class="maintainer__item"><img src="TORM%20%20um%20ORM%20simples%20para%20PHP%20%20%20iMasters_arquivos/fiap-1-1.png"></a><a href="http://gama.academy/pt/programas/experience?utm_campaign=iMasters_site-lp-gama_experience-sp-devs&amp;#038;utm_medium=cpc&amp;#038;utm_source=iMasters_site&amp;#038;utm_content=vagas_devs&amp;#038;utm_term=" class="maintainer__item"><img src="TORM%20%20um%20ORM%20simples%20para%20PHP%20%20%20iMasters_arquivos/gama-academy-im.png"></a><a href="http://www.hostgator.com.br/?utm_source=imasters2018&amp;#038;utm_medium=eventos" class="maintainer__item"><img src="TORM%20%20um%20ORM%20simples%20para%20PHP%20%20%20iMasters_arquivos/Hostgator-brasil.png"></a><a href="https://www.idexo.com.br/" class="maintainer__item"><img src="TORM%20%20um%20ORM%20simples%20para%20PHP%20%20%20iMasters_arquivos/idexo.png"></a><a href="http://www.impacta.com.br/" class="maintainer__item"><img src="TORM%20%20um%20ORM%20simples%20para%20PHP%20%20%20iMasters_arquivos/impacta-85-49.png"></a><a href="https://www.kinghost.com.br/" class="maintainer__item"><img src="TORM%20%20um%20ORM%20simples%20para%20PHP%20%20%20iMasters_arquivos/kinghost-3.png"></a><a href="http://lambda3.com.br/" class="maintainer__item"><img src="TORM%20%20um%20ORM%20simples%20para%20PHP%20%20%20iMasters_arquivos/lambda-1-1.png"></a><a href="https://www.locaweb.com.br/?utm_campaign=portalimasters&amp;#038;utm_source=portalimasters&amp;#038;utm_medium=news&amp;#038;utm_content=link" class="maintainer__item"><img src="TORM%20%20um%20ORM%20simples%20para%20PHP%20%20%20iMasters_arquivos/locaweb-4.png"></a><a href="https://pagseguro.uol.com.br/" class="maintainer__item"><img src="TORM%20%20um%20ORM%20simples%20para%20PHP%20%20%20iMasters_arquivos/pagseguro.jpg"></a><a href="https://www.userede.com.br/" class="maintainer__item"><img src="TORM%20%20um%20ORM%20simples%20para%20PHP%20%20%20iMasters_arquivos/rede-3.png"></a><a href="https://br.resellerclub.com/webpro?utm_source=imasters" class="maintainer__item"><img src="TORM%20%20um%20ORM%20simples%20para%20PHP%20%20%20iMasters_arquivos/resellerclub-1.png"></a><a href="https://uolhost.uol.com.br/" class="maintainer__item"><img src="TORM%20%20um%20ORM%20simples%20para%20PHP%20%20%20iMasters_arquivos/uolhost-2.png"></a><a href="http://www.zarpsystem.com.br/" class="maintainer__item"><img src="TORM%20%20um%20ORM%20simples%20para%20PHP%20%20%20iMasters_arquivos/zarpsystem.jpg"></a></div></div><div><div class="maintainer__header"><h2 class="maintainer__title">Este projeto é apoiado pelas empresas</h2></div><div class="maintainer__list"><a href="http://portal.embratel.com.br/cloud/index.php" class="maintainer__item"><img src="TORM%20%20um%20ORM%20simples%20para%20PHP%20%20%20iMasters_arquivos/embratel-small.png"></a><a href="https://gerencianet.com.br/lp/imasters/" class="maintainer__item"><img src="TORM%20%20um%20ORM%20simples%20para%20PHP%20%20%20iMasters_arquivos/gerencianet-small.png"></a><a href="https://pagar.me/" class="maintainer__item"><img src="TORM%20%20um%20ORM%20simples%20para%20PHP%20%20%20iMasters_arquivos/pagarme-1.png"></a></div></div><div class="maintainer__featured"></div></div></div><div class="newsletter"><div class="container"><div class="newsletter__box"><form><header class="newsletter__header"><h2 class="title-highlight">Assine nossa<strong class="title-highlight__large">Newsletter</strong></h2><p>Fique em dia com as novidades do iMasters! Assine nossa newsletter e receba conteúdos especiais curados por nossa equipe</p></header><div class="newsletter__form"><span id="" class="field--has-icon field field--email  "><span class="field__content"><input id="" name="newsletterEmail" placeholder="Qual é o seu e-mail?" type="email"><span class="icon icon--package "><svg width="20px" height="20px" viewBox="0 0 28 30"><title>package</title><path fill="currentColor" d="M20.572 11.435c-0.008 0.004-0.016 0.008-0.024 0.012l-5.548 2.774v12.211l9.306-4.653c0.425-0.211 0.693-0.644 0.694-1.118v-11.44l-4.428 2.214zM10.301 4.077l9.699 4.849 3.449-1.724-9.144-4.572c-0.35-0.174-0.761-0.173-1.109-0.001l-2.895 1.448zM7.506 5.474l-3.455 1.727 9.699 4.849 3.455-1.727-9.699-4.849zM6.836 3.014c0.068-0.042 0.139-0.078 0.213-0.107l5.032-2.516c1.051-0.522 2.286-0.522 3.338 0l10 5c1.274 0.633 2.080 1.933 2.081 3.357v11.913c-0.001 1.423-0.807 2.723-2.078 3.355l-10 5c-1.056 0.529-2.3 0.529-3.356 0l-10.003-5.002c-1.273-0.641-2.072-1.949-2.063-3.366v-11.901c0.001-1.423 0.807-2.723 2.078-3.355l4.758-2.379zM12.5 26.439v-12.217l-10-5-0 11.436c-0.003 0.475 0.263 0.911 0.684 1.123l9.316 4.658z"></path></svg></span></span></span><button type="submit" class="btn-primary btn-primary--submit">Assinar</button></div></form></div></div></div><div class="footer__main"><div class="container"><h2 class="branding"><img src="TORM%20%20um%20ORM%20simples%20para%20PHP%20%20%20iMasters_arquivos/imasters-logo.png" alt="iMaster Developers"></h2><div class="navigation-footer"><ul class="menu menu--small"><li class="menu__item"><a href="https://imasters.com.br/p/sobre-o-imasters" target="_self" title="Sobre o iMasters">Sobre o iMasters</a></li><li class="menu__item"><a href="https://imasters.com.br/p/politica-de-privacidade" target="_self" title="Política de Privacidade">Política de Privacidade</a></li><li class="menu__item"><a href="https://imasters.com.br/fale-conosco/" target="_self" title="Fale conosco">Fale conosco</a></li><li class="menu__item"><a href="https://imasters.com.br/p/quero-ser-autor" target="_self" title="Quero ser autor">Quero ser autor</a></li><li class="menu__item"><a href="https://forum.imasters.com.br/" target="_blank" title="Fórum">Fórum</a></li><li class="menu__item"><a href="https://setemasters.imasters.com.br/" target="_blank" title="7Masters">7Masters</a></li><li class="menu__item"><a href="https://imasters.com.br/agenda/" target="_self" title="Agenda">Agenda</a></li><li class="menu__item"><a href="https://imasters.com/" target="_blank" title="iMasters.com">iMasters.com</a></li></ul></div></div></div></footer></div></main></div><script>window.__INITIAL_STATE__ = {"environment":{"isMobile":false,"url":"http:\u002F\u002Fimasters.com.br\u002Fback-end\u002Ftorm-um-orm-simples-para-php"},"footer":{"success":true,"menu":[{"ID":138747,"order":1,"parent":0,"title":"Sobre o iMasters","url":"\u002Fp\u002Fsobre-o-imasters","attr":"","target":"","classes":"","xfn":"","description":"","object_id":37977,"object":"page","type":"post_type","type_label":"Página","children":[]},{"ID":138745,"order":2,"parent":0,"title":"Política de Privacidade","url":"\u002Fp\u002Fpolitica-de-privacidade","attr":"","target":"","classes":"","xfn":"","description":"","object_id":38206,"object":"page","type":"post_type","type_label":"Página","children":[]},{"ID":139083,"order":3,"parent":0,"title":"Fale conosco","url":"https:\u002F\u002Fimasters.com.br\u002Ffale-conosco\u002F","attr":"","target":"","classes":"","xfn":"","description":"","object_id":139083,"object":"custom","type":"custom","type_label":"Link personalizado","children":[]},{"ID":138746,"order":4,"parent":0,"title":"Quero ser autor","url":"\u002Fp\u002Fquero-ser-autor","attr":"","target":"","classes":"","xfn":"","description":"","object_id":123055,"object":"page","type":"post_type","type_label":"Página","children":[]},{"ID":138748,"order":5,"parent":0,"title":"Fórum","url":"https:\u002F\u002Fforum.imasters.com.br\u002F","attr":"","target":"_blank","classes":"","xfn":"","description":"","object_id":138748,"object":"custom","type":"custom","type_label":"Link personalizado","children":[]},{"ID":138750,"order":6,"parent":0,"title":"7Masters","url":"https:\u002F\u002Fsetemasters.imasters.com.br\u002F","attr":"","target":"_blank","classes":"","xfn":"","description":"","object_id":138750,"object":"custom","type":"custom","type_label":"Link personalizado","children":[]},{"ID":139070,"order":7,"parent":0,"title":"Agenda","url":"https:\u002F\u002Fimasters.com.br\u002Fagenda\u002F","attr":"","target":"","classes":"","xfn":"","description":"","object_id":139070,"object":"custom","type":"custom","type_label":"Link personalizado","children":[]},{"ID":138749,"order":8,"parent":0,"title":"iMasters.com","url":"https:\u002F\u002Fimasters.com\u002F","attr":"","target":"_blank","classes":"","xfn":"","description":"","object_id":138749,"object":"custom","type":"custom","type_label":"Link personalizado","children":[]}],"companies":{"maintainers":[{"id":114197,"title":"Banco Original","excerpt":"","link":"http:\u002F\u002Fdevelopers.original.com.br","thumbnail":"https:\u002F\u002Fstatic.imasters.com.br\u002Fwp-content\u002Fuploads\u002F2017\u002F04\u002Fbanco-original-2.png","customText":""},{"id":72700,"title":"Cielo","excerpt":"","link":"https:\u002F\u002Fdesenvolvedores.cielo.com.br\u002Fapi-portal\u002F","thumbnail":"https:\u002F\u002Fstatic.imasters.com.br\u002Fwp-content\u002Fuploads\u002F2015\u002F01\u002Fcielo-3.png","customText":""},{"id":115575,"title":"DialHost","excerpt":"","link":"https:\u002F\u002Fwww.dialhost.com.br\u002F?utm_campaign=patrocinio_iMasters&#038;utm_source=iMasters&#038;utm_medium=marca","thumbnail":"https:\u002F\u002Fstatic.imasters.com.br\u002Fwp-content\u002Fuploads\u002F2017\u002F05\u002Fdialhost-1.png","customText":"Hospedado por: "},{"id":72706,"title":"FIAP","excerpt":"","link":"https:\u002F\u002Fwww.fiap.com.br\u002F?utm_source=imasters&#038;utm_medium=logo-rodape&#038;utm_campaign=imasters2018","thumbnail":"https:\u002F\u002Fstatic.imasters.com.br\u002Fwp-content\u002Fuploads\u002F2015\u002F01\u002Ffiap-1-1.png","customText":""},{"id":113983,"title":"Gama Academy","excerpt":"","link":"http:\u002F\u002Fgama.academy\u002Fpt\u002Fprogramas\u002Fexperience?utm_campaign=iMasters_site-lp-gama_experience-sp-devs&#038;utm_medium=cpc&#038;utm_source=iMasters_site&#038;utm_content=vagas_devs&#038;utm_term=","thumbnail":"https:\u002F\u002Fstatic.imasters.com.br\u002Fwp-content\u002Fuploads\u002F2017\u002F05\u002Fgama-academy-im.png","customText":"Capacitação e Seleção:"},{"id":124439,"title":"HostGator","excerpt":"","link":"http:\u002F\u002Fwww.hostgator.com.br\u002F?utm_source=imasters2018&#038;utm_medium=eventos","thumbnail":"https:\u002F\u002Fstatic.imasters.com.br\u002Fwp-content\u002Fuploads\u002F2018\u002F01\u002FHostgator-brasil.png","customText":""},{"id":125461,"title":"iDEXO","excerpt":"","link":"https:\u002F\u002Fwww.idexo.com.br\u002F","thumbnail":"https:\u002F\u002Fstatic.imasters.com.br\u002Fwp-content\u002Fuploads\u002F2018\u002F01\u002Fidexo.png","customText":""},{"id":72717,"title":"Impacta","excerpt":"","link":"http:\u002F\u002Fwww.impacta.com.br","thumbnail":"https:\u002F\u002Fstatic.imasters.com.br\u002Fwp-content\u002Fuploads\u002F2015\u002F01\u002Fimpacta-85-49.png","customText":""},{"id":72720,"title":"KingHost","excerpt":"","link":"https:\u002F\u002Fwww.kinghost.com.br\u002F","thumbnail":"https:\u002F\u002Fstatic.imasters.com.br\u002Fwp-content\u002Fuploads\u002F2015\u002F01\u002Fkinghost-3.png","customText":""},{"id":110003,"title":"Lambda3","excerpt":"\u003Cp\u003EInteligência e inovação em desenvolvimento de software.\u003C\u002Fp\u003E\n","link":"http:\u002F\u002Flambda3.com.br\u002F","thumbnail":"https:\u002F\u002Fstatic.imasters.com.br\u002Fwp-content\u002Fuploads\u002F2016\u002F12\u002Flambda-1-1.png","customText":""},{"id":72724,"title":"Locaweb","excerpt":"","link":"https:\u002F\u002Fwww.locaweb.com.br\u002F?utm_campaign=portalimasters&#038;utm_source=portalimasters&#038;utm_medium=news&#038;utm_content=link","thumbnail":"https:\u002F\u002Fstatic.imasters.com.br\u002Fwp-content\u002Fuploads\u002F2015\u002F01\u002Flocaweb-4.png","customText":""},{"id":102795,"title":"PagSeguro","excerpt":"","link":"https:\u002F\u002Fpagseguro.uol.com.br\u002F","thumbnail":"https:\u002F\u002Fstatic.imasters.com.br\u002Fwp-content\u002Fuploads\u002F2016\u002F08\u002Fpagseguro.jpg","customText":""},{"id":110170,"title":"Rede","excerpt":"","link":"https:\u002F\u002Fwww.userede.com.br\u002F","thumbnail":"https:\u002F\u002Fstatic.imasters.com.br\u002Fwp-content\u002Fuploads\u002F2017\u002F01\u002Frede-3.png","customText":""},{"id":72770,"title":"ResellerClub","excerpt":"","link":"https:\u002F\u002Fbr.resellerclub.com\u002Fwebpro?utm_source=imasters","thumbnail":"https:\u002F\u002Fstatic.imasters.com.br\u002Fwp-content\u002Fuploads\u002F2015\u002F01\u002Fresellerclub-1.png","customText":""},{"id":72772,"title":"UOL HOST","excerpt":"","link":"https:\u002F\u002Fuolhost.uol.com.br\u002F","thumbnail":"https:\u002F\u002Fstatic.imasters.com.br\u002Fwp-content\u002Fuploads\u002F2015\u002F01\u002Fuolhost-2.png","customText":""},{"id":118680,"title":"ZarpSystem","excerpt":"","link":"http:\u002F\u002Fwww.zarpsystem.com.br\u002F","thumbnail":"https:\u002F\u002Fstatic.imasters.com.br\u002Fwp-content\u002Fuploads\u002F2017\u002F08\u002Fzarpsystem.jpg","customText":""}],"others":[],"offering":[{"id":138839,"title":"Elo","excerpt":"","link":"https:\u002F\u002Fwww.cartaoelo.com.br","thumbnail":"https:\u002F\u002Fstatic.imasters.com.br\u002Fwp-content\u002Fuploads\u002F2018\u002F05\u002F29100832\u002Felo.jpg","customText":""},{"id":125623,"title":"iFood","excerpt":"","link":"https:\u002F\u002Fwww.linkedin.com\u002Fjobs\u002Fsearch\u002F?f_C=247645&#038;location=Mundialmente&#038;locationId=OTHERS.worldwide&#038;start=25","thumbnail":"https:\u002F\u002Fstatic.imasters.com.br\u002Fwp-content\u002Fuploads\u002F2018\u002F02\u002Fifood.png","customText":""},{"id":125625,"title":"Movile","excerpt":"","link":"http:\u002F\u002Fwww.movile.com\u002Fjobs","thumbnail":"https:\u002F\u002Fstatic.imasters.com.br\u002Fwp-content\u002Fuploads\u002F2018\u002F02\u002Fmovile.png","customText":""}],"supporters":[{"id":99254,"title":"Embratel","excerpt":"","link":"http:\u002F\u002Fportal.embratel.com.br\u002Fcloud\u002Findex.php","thumbnail":"https:\u002F\u002Fstatic.imasters.com.br\u002Fwp-content\u002Fuploads\u002F2016\u002F05\u002Fembratel-small.png","customText":""},{"id":72709,"title":"Gerencianet","excerpt":"","link":"https:\u002F\u002Fgerencianet.com.br\u002Flp\u002Fimasters\u002F","thumbnail":"https:\u002F\u002Fstatic.imasters.com.br\u002Fwp-content\u002Fuploads\u002F2015\u002F01\u002Fgerencianet-small.png","customText":""},{"id":128731,"title":"Pagar.me","excerpt":"","link":"https:\u002F\u002Fpagar.me\u002F","thumbnail":"https:\u002F\u002Fstatic.imasters.com.br\u002Fwp-content\u002Fuploads\u002F2018\u002F04\u002Fpagarme-1.png","customText":""}]}},"article":{"success":true,"data":{"id":48856,"title":"TORM: um ORM simples para PHP","content":"\u003Cp\u003EAlgum tempo atrás peguei um projeto em um cliente novo que não quis fazer o projeto utilizando \u003Ccode\u003ERails\u003C\u002Fcode\u003E, por motivos que concernem apenas à ele, mas como argumentação básica que o time de desenvolvedores já utiliza PHP &#8220;puro&#8221; e a curva de aprendizado do Rails para a equipe toda seria algo que eles não gostariam de lidar.\u003C\u002Fp\u003E\n\u003Cp\u003EAtualmente, nem estou trabalhando com projetos web fora do eixo Ruby\u002FRails\u002FSinatra, porém era um projeto interessante e resolvi topar, com a condição de que eu teria pelo menos um ORM em PHP para trabalhar. E eles concordaram.\u003C\u002Fp\u003E\n\u003Cp\u003EApós avaliar alguns ORMs em PHP por aí, não gostei muito de nenhum, com exceção do \u003Ca href=\"http:\u002F\u002Fcodehappy.daylerees.com\u002Feloquent-orm\"\u003EEloquent\u003C\u002Fa\u003E, que para ser utilizado fora do \u003Ca href=\"http:\u002F\u002Flaravel.com\u002F\"\u003ELaravel\u003C\u002Fa\u003E exigia um pouco mais de ginástica e outro pacote. Então, decidi fazer o meu próprio, o \u003Ca href=\"http:\u002F\u002Ftaq.github.io\u002Ftorm\u002F\"\u003ETORM\u003C\u002Fa\u003E, que no final das contas ficou (e está ficando) bem interessante, tentando descaradamente copiar várias features do \u003Ca href=\"http:\u002F\u002Fpt.wikipedia.org\u002Fwiki\u002FActive_record\"\u003EActiveRecord\u003C\u002Fa\u003E.\u003C\u002Fp\u003E\n\u003Ch2\u003EConectando no banco\u003C\u002Fh2\u003E\n\u003Cp\u003EA configuração dele é simples: a parte da conexão com o banco é feita através do \u003Ca href=\"http:\u002F\u002Fphp.net\u002Fmanual\u002Fpt_BR\u002Fbook.pdo.php\"\u003EPDO\u003C\u002Fa\u003E, e tudo o que é necessário para o funcionamento está no arquivo \u003Ccode\u003Etorm.php\u003C\u002Fcode\u003E. Vamos utilizar de exemplo o \u003Ca href=\"http:\u002F\u002Fwww.sqlite.org\u002F\"\u003ESQLite\u003C\u002Fa\u003E (mas já tem suporte para o \u003Ca href=\"http:\u002F\u002Fwww.mysql.com\u002F\"\u003EMySQL\u003C\u002Fa\u003E e o \u003Ca href=\"http:\u002F\u002Fwww.oracle.com\u002F\"\u003EOracle\u003C\u002Fa\u003E):\u003C\u002Fp\u003E\n\u003Cpre class=\"brush: php; gutter: true\"\u003Einclude &quot;torm.php&quot;;\r\n\r\n$con = new PDO(&quot;sqlite:database.sqlite3&quot;);\r\nTORM\\Connection::setConnection($con);\r\nTORM\\Connection::setDriver(&quot;sqlite&quot;);\u003C\u002Fpre\u003E\n\u003Ch2\u003EModelos\u003C\u002Fh2\u003E\n\u003Cp\u003EPara definir os modelos é fácil: é só seguir a convenção (copiada do \u003Ccode\u003EActiveRecord\u003C\u002Fcode\u003E) do nome da classe no singular ser o nome da tabela no plural (inclusive \u003Ca href=\"https:\u002F\u002Fgithub.com\u002Ftaq\u002Ftorm\u002Fwiki\u002FModels\"\u003Etem até suporte para pluralizações\u003C\u002Fa\u003E):\u003C\u002Fp\u003E\n\u003Cpre class=\"brush: php; gutter: true\"\u003Eclass User extends TORM\\Model {};\r\nclass Ticket extends TORM\\Model {};\u003C\u002Fpre\u003E\n\u003Ch2\u003EValidações\u003C\u002Fh2\u003E\n\u003Cp\u003EPodemos especificar algumas \u003Ca href=\"https:\u002F\u002Fgithub.com\u002Ftaq\u002Ftorm\u002Fwiki\u002Fvalidations\"\u003Evalidações\u003C\u002Fa\u003E facilmente:\u003C\u002Fp\u003E\n\u003Cpre class=\"brush: php; gutter: true\"\u003EUser::validates(&quot;name&quot;, array(&quot;presence&quot;=&gt;true));\r\nUser::validates(&quot;email&quot;, array(&quot;presence&quot;=&gt;true));\r\nUser::validates(&quot;email&quot;, array(&quot;uniqueness&quot;=&gt;true));\r\nUser::validates(&quot;id&quot;, array(&quot;numericality&quot;=&gt;true));\u003C\u002Fpre\u003E\n\u003Ch2\u003ERelacionamentos\u003C\u002Fh2\u003E\n\u003Cp\u003EOs relacionamentos podem ser definidos como:\u003C\u002Fp\u003E\n\u003Cpre class=\"brush: php; gutter: true\"\u003EUser::hasMany(&quot;tickets&quot;);\r\nUser::hasOne(&quot;account&quot;);\r\nTicket::belongsTo(&quot;user&quot;);\u003C\u002Fpre\u003E\n\u003Ch2\u003EManipulando registros\u003C\u002Fh2\u003E\n\u003Cp\u003EPara criar um registro novo de \u003Ccode\u003EUser\u003C\u002Fcode\u003E:\u003C\u002Fp\u003E\n\u003Cpre class=\"brush: php; gutter: true\"\u003E$user = new User();\r\n$user-&gt;name  = &quot;John Doe&quot;;\r\n$user-&gt;email = &quot;john@doe.com&quot;;\r\n$user-&gt;level = 1\r\n$user-&gt;save()\u003C\u002Fpre\u003E\n\u003Cp\u003EPara procurar através do id (que por convenção é a chave primária):\u003C\u002Fp\u003E\n\u003Cpre class=\"brush: php; gutter: true\"\u003E$user = User::find(1);\u003C\u002Fpre\u003E\n\u003Cp\u003EPara procurar todos em determinadas condições:\u003C\u002Fp\u003E\n\u003Cpre class=\"brush: php; gutter: true\"\u003E$users = User::where(array(&quot;level&quot;=&gt;1));\u003C\u002Fpre\u003E\n\u003Cp\u003EAtualizar vários registros de uma vez:\u003C\u002Fp\u003E\n\u003Cpre class=\"brush: php; gutter: true\"\u003EUser::where(array(&quot;level&quot;=&gt;1))-&gt;updateAttributes(array(&quot;level&quot;=&gt;3));\u003C\u002Fpre\u003E\n\u003Cp\u003EUtilizar queries fluentes:\u003C\u002Fp\u003E\n\u003Cpre class=\"brush: php; gutter: true\"\u003E$users = User::where(array(&quot;level&quot;=&gt;1)).limit(5).order(&quot;name desc&quot;);\u003C\u002Fpre\u003E\n\u003Cp\u003EUtilizar os relacionamentos:\u003C\u002Fp\u003E\n\u003Cpre class=\"brush: php; gutter: true\"\u003Eforeach($user-&gt;tickets as $ticket)\r\n    echo $ticket-&gt;description;\r\n\r\necho $user-&gt;account-&gt;number;\u003C\u002Fpre\u003E\n\u003Cp\u003EFora isso, ainda tem suporte à \u003Ca href=\"https:\u002F\u002Fgithub.com\u002Ftaq\u002Ftorm\u002Fwiki\u002Fscopes\"\u003Eescopos\u003C\u002Fa\u003E, \u003Ca href=\"https:\u002F\u002Fgithub.com\u002Ftaq\u002Ftorm\u002Fwiki\u002FModels#callbacks\"\u003E\u003Cem\u003Ecallbacks\u003C\u002Fem\u003E\u003C\u002Fa\u003E, \u003Ca href=\"https:\u002F\u002Fgithub.com\u002Ftaq\u002Ftorm\u002Fwiki\u002Ffactories\"\u003E\u003Cem\u003Efactories\u003C\u002Fem\u003E\u003C\u002Fa\u003E, \u003Ca href=\"https:\u002F\u002Fgithub.com\u002Ftaq\u002Ftorm\u002Fwiki\u002Fpagination\"\u003Epaginação\u003C\u002Fa\u003E, etc. E ainda falta muita coisa que eu quero colocar por lá. Vejam a \u003Ca href=\"https:\u002F\u002Fgithub.com\u002Ftaq\u002Ftorm\u002Fwiki\u002Finstalling\"\u003Eseção de instalação\u003C\u002Fa\u003E se resolverem testar o danado.\u003C\u002Fp\u003E\n\u003Cp\u003ESe você se encontra em um projeto como esse do meu cliente, onde não pode usar \u003Ca href=\"http:\u002F\u002Frubyonrails.org\u002F\"\u003ERails\u003C\u002Fa\u003E e tem que usar \u003Ca href=\"http:\u002F\u002Fphp.net\u002F\"\u003EPHP\u003C\u002Fa\u003E, pode ser que esse projeto seja de alguma valia e ajuda.\u003C\u002Fp\u003E\n","excerpt":"\u003Cp\u003EEustáquio conta como foi criar um ORMs em PHP que suprisse as suas necessidades para desenvolver um projeto utilizando PHP puro.\u003C\u002Fp\u003E\n","link":"https:\u002F\u002Fimasters.com.br\u002Fback-end\u002Ftorm-um-orm-simples-para-php","date":"10 out, 2013","thumbnail":"","externalMention":null,"author":{"id":6965,"thumbnail":"https:\u002F\u002Fsecure.gravatar.com\u002Favatar\u002F36a7207dc8c3974a330919128af15cc9?s=96&d=mm&r=g","name":"Eustáquio Rangel","description":"é desenvolvedor Java, PHP e Ruby, que é seu principal foco desde 2004 e que lhe rendeu um livro.","slug":"eustaquio_rangel","url":"\u002Fperfil\u002Feustaquio_rangel","registered":"2009-02-10 17:47:52","social":{"linkedin":null,"youtube":null,"facebook":null,"twitter":null,"instagram":null,"github":null},"articles_count":12,"views_count":15192,"certifications":null,"conquests":null,"office":null,"articles":[{"id":107520,"title":"Utilizando muitas gems no seu projeto?","content":"\u003Cp\u003EUma das coisas bem azeitadas e que funcionam muito bem no mundo Ruby, e consequentemente no mundo Rails, é o gerenciamento de dependências de recursos externos ao seu projeto através das \u003Cem\u003Egems\u003C\u002Fem\u003E, onde podemos incorporar várias funcionalidades interessantes de maneira fácil, rápida e segura &#8211; algumas vezes.\u003C\u002Fp\u003E\n\u003Ch2\u003ERodas e rodas\u003C\u002Fh2\u003E\n\u003Cp\u003ESempre que começamos a falar sobre esses recursos externos, vem a frase &#8220;claro, já tem pronto, para que inventar a roda?&#8221;, como se fosse uma máxima de maneira genérica para todas as situações. Isso não é verdade, pois às vezes não precisaríamos da roda inteira, especialmente se ela fosse de liga leve feita com alumínio, magnésio, silício, titânio e\u002Fou estrôncio, cromadas e pneus de F1. Nesse caso, não estamos reinventando a roda, mas utilizando mais do que realmente necessário, o que pode ser à primeira vista uma vantagem mas que mais tarde pode se provar um problema na manutenção. Pode ser que o que precisávamos mesmo era uma roda simples, de carroça, que resolveria o problema de maneira efetiva, com parcimônia e eficiência. E que se fosse necessário fazer uma na mão, também não daria tanto trabalho.\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Ca href=\"https:\u002F\u002Fstatic.imasters.com.br\u002Fwp-content\u002Fuploads\u002F2016\u002F11\u002Froda-de-carroca.jpg\"\u003E\u003Cimg class=\"aligncenter size-full wp-image-107529\" src=\"https:\u002F\u002Fstatic.imasters.com.br\u002Fwp-content\u002Fuploads\u002F2016\u002F11\u002Froda-de-carroca.jpg\" alt=\"roda-de-carroca\" width=\"400\" height=\"333\" srcset=\"https:\u002F\u002Fstatic.imasters.com.br\u002Fwp-content\u002Fuploads\u002F2016\u002F11\u002Froda-de-carroca.jpg 400w, https:\u002F\u002Fstatic.imasters.com.br\u002Fwp-content\u002Fuploads\u002F2016\u002F11\u002Froda-de-carroca-300x250.jpg 300w\" sizes=\"(max-width: 400px) 100vw, 400px\" \u002F\u003E\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n\u003Ch2\u003ECírculo de confiança\u003C\u002Fh2\u003E\n\u003Cp\u003EAlém da confiança que temos automaticamente no recurso associado ao projeto, em relação ao fato de que o seu código vai cumprir o prometido &#8211; seja na medida do que é necessário ou entregando mais do que precisamos -, temos também a confiança de que o código sendo associado está livre de quaisquer problemas de segurança. Hoje as pessoas têm se esquecido bastante disso em parte porque várias ferramentas que utilizamos fazem a verificação de autenticidade do código, como os pacotes que são instalados\u002Fatualizados em distribuições GNU\u002FLinux como o Ubuntu. Se você não conhece como funciona esse processo, \u003Ca href=\"https:\u002F\u002Fwiki.debian.org\u002FSecureApt\"\u003Eaqui tem um link legal sobre o assunto\u003C\u002Fa\u003E. Outra parte em que as pessoas se esquecem bastante disso é porque, sinceramente, estão se lixando para esse assunto, o que é um erro que só vai dar dor de cabeça quando acontecer alguma coisa bem ruim no computador da pessoa.\u003C\u002Fp\u003E\n\u003Cp\u003EExistem algumas maneiras de garantir que a autenticidade do código da \u003Cem\u003Egem\u003C\u002Fem\u003E que está sendo instalada venha da fonte esperada, inclusive \u003Ca href=\"http:\u002F\u002Feustaquiorangel.com\u002Fposts\u002Fassinando_e_utilizando_gems_assinadas\"\u003Eeu já comentei sobre isso algum tempo atrás\u003C\u002Fa\u003E, em um artigo falando sobre \u003Cem\u003Egems\u003C\u002Fem\u003E assinadas, que podem garantir a autenticidade do código e também adicionar uma camada de segurança, pois para que a \u003Cem\u003Egem\u003C\u002Fem\u003E tenha lido liberada, ela tem que ser assinada com a chave do desenvolvedor. Mesmo se alguém roubar o computador do desenvolvedor responsável pela \u003Cem\u003Egem\u003C\u002Fem\u003E, a pessoa ainda teria que saber a senha de assinatura, e vamos convencionar que alguém que assina o seu código não vai ter uma senha como &#8220;123456&#8221;. \u003Ca href=\"https:\u002F\u002Fwww.sitepoint.com\u002Fruby-devs-your-gems-could-screw-you\u002F\"\u003EAqui tem um artigo interessante sobre essa confiança no código\u003C\u002Fa\u003E. Mas, mesmo assim, se o código for autenticado, temos que confiar que ele não vá fazer nada nocivo. Difícil ocorrer algo do tipo, mas existe o \u003Ca href=\"http:\u002F\u002Frubysec.com\u002F\"\u003ERubySec\u003C\u002Fa\u003E para dar uma &#8220;policiada&#8221; na coisa e \u003Ca href=\"https:\u002F\u002Fhakiri.io\u002Fblog\u002Fruby-security-tools-and-resources\"\u003Ealgumas ferramentas\u003C\u002Fa\u003E para ajudar a policiar a segurança do seu projeto.\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Ca href=\"https:\u002F\u002Fstatic.imasters.com.br\u002Fwp-content\u002Fuploads\u002F2016\u002F11\u002Fcircle-of-trust.jpg\"\u003E\u003Cimg class=\"aligncenter size-full wp-image-107531\" src=\"https:\u002F\u002Fstatic.imasters.com.br\u002Fwp-content\u002Fuploads\u002F2016\u002F11\u002Fcircle-of-trust.jpg\" alt=\"circle-of-trust\" width=\"400\" height=\"267\" srcset=\"https:\u002F\u002Fstatic.imasters.com.br\u002Fwp-content\u002Fuploads\u002F2016\u002F11\u002Fcircle-of-trust.jpg 400w, https:\u002F\u002Fstatic.imasters.com.br\u002Fwp-content\u002Fuploads\u002F2016\u002F11\u002Fcircle-of-trust-158x106.jpg 158w, https:\u002F\u002Fstatic.imasters.com.br\u002Fwp-content\u002Fuploads\u002F2016\u002F11\u002Fcircle-of-trust-300x200.jpg 300w\" sizes=\"(max-width: 400px) 100vw, 400px\" \u002F\u003E\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n\u003Ch2\u003EExagero\u003C\u002Fh2\u003E\n\u003Cp\u003EÀs vezes parece que fazer uma aplicação é entrar na sessão de Lego da loja de brinquedos, abrir todas as caixas que têm pecinhas legais e sair juntando tudo. Ok, em uma loja de brinquedos isso seria bem legal, mas em uma aplicação, calma lá. É fácil ser seduzido por uma roda de liga leve cromada bonitona como exemplificado no começo do artigo, mas, assim como qualquer linha de código adicionada é uma linha que você ou alguém vai ter que manter mais tarde (\u003Ca href=\"http:\u002F\u002Fwww.skrenta.com\u002F2007\u002F05\u002Fcode_is_our_enemy.html\"\u003Eaqui tem um artigo legal sobre isso\u003C\u002Fa\u003E), qualquer dependência não tão bem pensada no seu projeto vai com certeza te assombrar de alguma forma no futuro. Ou talvez não. Algumas \u003Cem\u003Egems\u003C\u002Fem\u003E são simples, diretas, com chance de ter pouca probabilidade de aumentar a complexidade tanto das dependências como do seu próprio código. Algumas vão carregar a memória com uma cascata recursiva de dependências, insistir em brigar com as outras, com o framework, com a própria linguagem, e aí, parceiro, a coisa complica. O \u003Ca href=\"https:\u002F\u002Fwww.toptal.com\u002Fruby-on-rails\u002Ftop-10-mistakes-that-rails-programmers-make\"\u003Eitem 5 deste artigo\u003C\u002Fa\u003E relaciona alguns desses problemas.\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Ca href=\"https:\u002F\u002Fstatic.imasters.com.br\u002Fwp-content\u002Fuploads\u002F2016\u002F11\u002Fcapitao-nascimento-vai-dar-merda.jpg\"\u003E\u003Cimg class=\"aligncenter size-full wp-image-107532\" src=\"https:\u002F\u002Fstatic.imasters.com.br\u002Fwp-content\u002Fuploads\u002F2016\u002F11\u002Fcapitao-nascimento-vai-dar-merda.jpg\" alt=\"capitao-nascimento-vai-dar-merda\" width=\"554\" height=\"299\" srcset=\"https:\u002F\u002Fstatic.imasters.com.br\u002Fwp-content\u002Fuploads\u002F2016\u002F11\u002Fcapitao-nascimento-vai-dar-merda.jpg 554w, https:\u002F\u002Fstatic.imasters.com.br\u002Fwp-content\u002Fuploads\u002F2016\u002F11\u002Fcapitao-nascimento-vai-dar-merda-300x162.jpg 300w\" sizes=\"(max-width: 554px) 100vw, 554px\" \u002F\u003E\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n\u003Ch2\u003ETendo uma ideia do tamanho da paulada\u003C\u002Fh2\u003E\n\u003Cp\u003EPara inspecionar como andam as dependências do seu projeto, existe um método bem prático. Vamos precisar instalar o \u003Cem\u003Egraphviz\u003C\u002Fem\u003E no sistema operacional, se já não estiver instalado:\u003C\u002Fp\u003E\n\u003Cpre class=\"brush: shell; gutter: true\"\u003E$ sudo apt-get install graphviz\u003C\u002Fpre\u003E\n\u003Cp\u003EInstalar a \u003Cem\u003Egem\u003C\u002Fem\u003E (vejam que não estou falando para colocar no \u003Cem\u003EGemfile\u003C\u002Fem\u003E do projeto e gerar mais uma dependência!):\u003C\u002Fp\u003E\n\u003Cpre class=\"brush: shell; gutter: true\"\u003Egem install ruby-graphviz\u003C\u002Fpre\u003E\n\u003Cp\u003Ee rodar o seguinte comando:\u003C\u002Fp\u003E\n\u003Cpre class=\"brush: shell; gutter: true\"\u003E$ bundle viz\u003C\u002Fpre\u003E\n\u003Cp\u003Eque vai gerar um arquivo chamado \u003Cem\u003Egem_graph.png\u003C\u002Fem\u003E no diretório corrente. Em uma aplicação Rails criada vazia, vai ser algo assim (clique para ampliar):\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Ca href=\"https:\u002F\u002Fstatic.imasters.com.br\u002Fwp-content\u002Fuploads\u002F2016\u002F11\u002Fgem_graph.png\"\u003E\u003Cimg class=\"aligncenter size-full wp-image-107534\" src=\"https:\u002F\u002Fstatic.imasters.com.br\u002Fwp-content\u002Fuploads\u002F2016\u002F11\u002Fgem_graph.png\" alt=\"gem_graph\" width=\"5098\" height=\"778\" srcset=\"https:\u002F\u002Fstatic.imasters.com.br\u002Fwp-content\u002Fuploads\u002F2016\u002F11\u002Fgem_graph.png 5098w, https:\u002F\u002Fstatic.imasters.com.br\u002Fwp-content\u002Fuploads\u002F2016\u002F11\u002Fgem_graph-300x46.png 300w, https:\u002F\u002Fstatic.imasters.com.br\u002Fwp-content\u002Fuploads\u002F2016\u002F11\u002Fgem_graph-620x95.png 620w\" sizes=\"(max-width: 5098px) 100vw, 5098px\" \u002F\u003E\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n","excerpt":"\u003Cp\u003EUma das coisas que funcionam muito bem no mundo Ruby é o gerenciamento de dependências de recursos externos ao seu projeto através das gems.\u003C\u002Fp\u003E\n","link":"https:\u002F\u002Fimasters.com.br\u002Fback-end\u002Futilizando-muitas-gems-no-seu-projeto","date":"9 nov, 2016","thumbnail":"","externalMention":null,"author":{"id":6965,"thumbnail":"https:\u002F\u002Fsecure.gravatar.com\u002Favatar\u002F36a7207dc8c3974a330919128af15cc9?s=96&d=mm&r=g","name":"Eustáquio Rangel","description":"é desenvolvedor Java, PHP e Ruby, que é seu principal foco desde 2004 e que lhe rendeu um livro.","slug":"eustaquio_rangel","url":"\u002Fperfil\u002Feustaquio_rangel","registered":"2009-02-10 17:47:52","social":{"linkedin":null,"youtube":null,"facebook":null,"twitter":null,"instagram":null,"github":null},"articles_count":12,"views_count":15192,"certifications":null,"conquests":null,"office":null},"categories":[{"title":"Back-End","slug":"back-end","id":7158,"link":"https:\u002F\u002Fimasters.com.br\u002Fback-end"},{"title":"Desenvolvimento","slug":"desenvolvimento","id":7234,"link":"https:\u002F\u002Fimasters.com.br\u002Fdesenvolvimento"},{"title":"Ruby","slug":"ruby","id":7231,"link":"https:\u002F\u002Fimasters.com.br\u002Flinguagens\u002Fruby"}],"tags":[{"title":"arquitetura de software","slug":"arquitetura-de-software","id":393,"link":"https:\u002F\u002Fimasters.com.br\u002Farquitetura-de-software"},{"title":"desenvolvimento","slug":"desenvolvimento-2","id":186,"link":"https:\u002F\u002Fimasters.com.br\u002Fdesenvolvimento-2"},{"title":"gem","slug":"gem","id":5115,"link":"https:\u002F\u002Fimasters.com.br\u002Fgem"},{"title":"ruby","slug":"ruby-2","id":389,"link":"https:\u002F\u002Fimasters.com.br\u002Fruby-2"}],"seo":{"open_graph":{"title":"Utilizando muitas gems no seu projeto? - iMasters - We are Developers","description":"Uma das coisas que funcionam muito bem no mundo Ruby é o gerenciamento de dependências de recursos externos ao seu projeto através das gems.","type":"article","locale":"pt_BR","site_name":"iMasters - We are Developers","image":false,"modified_time":"2018-05-24T12:11:01-03:00","published_time":"2016-11-09T14:00:17-03:00"},"twitter":{"title":"Utilizando muitas gems no seu projeto? - iMasters - We are Developers","description":"Uma das coisas que funcionam muito bem no mundo Ruby é o gerenciamento de dependências de recursos externos ao seu projeto através das gems.","type":"summary_large_image","image":false}},"type":"post"},{"id":87501,"title":"Criando volumes encriptados com LUKS no GNU\u002FLinux","content":"\u003Cp\u003EEsses dias eu precisei montar um volume encriptado para gravar algumas informações que achava interessante ficarem isoladas do restante do disco. Nada de teorias de conspiração (vocês sabiam que tenho interesse muito grande por ufologia? posso contar essa história qualquer dia ..) nem nenhum material de alguma bizarrice pornô, apenas algumas coisas que às vezes aparecem que não acho interessante gravar como de costume no Evernote ou armazenar no Google Drive. Criar o volume é um dos passos &#8211; fáceis &#8211; mas é muito importante outro passo que a gente sempre esquece. \u003Cstrong\u003EImportante: use esses procedimentos por sua conta e risco!\u003C\u002Fstrong\u003E.\u003C\u002Fp\u003E\n\u003Ch2\u003ECriando o volume\u003C\u002Fh2\u003E\n\u003Cp\u003EPrimeiro vamos criar o volume usando o \u003Ca href=\"https:\u002F\u002Fen.wikipedia.org\u002Fwiki\u002FLinux_Unified_Key_Setup\"\u003ELUKS\u003C\u002Fa\u003E, que é uma especificação para encriptar discos que apesar de originalmente destinada para o \u003Ca href=\"http:\u002F\u002Flinux.org\"\u003EGNU\u002FLinux\u003C\u002Fa\u003E, roda até em sistemas com windows.\u003C\u002Fp\u003E\n\u003Cp\u003EPara criar o volume, temos primeiro que estipular um tamanho bom para ele. Para nosso exemplo, vamos criar um volume com 100 Mb de tamanho, criando um novo arquivo com esse tamanho através do utilitário \u003Ccode\u003Edd\u003C\u002Fcode\u003E, no diretório de sua preferência (aqui eu vou usar o \u003Ccode\u003E\u002Ftmp\u003C\u002Fcode\u003E para o exemplo, mas \u003Cstrong\u003Enunca\u003C\u002Fstrong\u003E use esse diretório pois distribuições como o \u003Ca href=\"http:\u002F\u002Fubuntu.com\"\u003EUbuntu\u003C\u002Fa\u003E apagam o conteúdo do danado quando são reiniciadas):\u003C\u002Fp\u003E\n\u003Cpre class=\"brush: text; gutter: true\"\u003Edd if=\u002Fdev\u002Fzero of=secret.img bs=1M count=100\u003C\u002Fpre\u003E\n\u003Cp\u003EExplicando um pouco o comando:\u003C\u002Fp\u003E\n\u003Col\u003E\n\u003Cli\u003EFoi utilizado como input (através de if) dos bytes o device \u002Fdev\u002Fzero, o que vai preencher o volume com um monte de zeros. Se você não estiver com pressa e tiver várias coisas rodando no computador, pode utilizar o \u002Fdev\u002Frandom, que vai deixar o volume mais seguro ainda).\u003C\u002Fli\u003E\n\u003Cli\u003EO output do comando foi para o arquivo secret.img, que pode ser dado qualquer nome (e extensão) que você quiser (gemeas_siamesas_e_bode.img, por exemplo, se você for uma pessoa bem pervertida e ingênua).\u003C\u002Fli\u003E\n\u003Cli\u003EO block size, que são os tamanhos dos blocos a serem alocados, foi indicado como sendo 1 Mb (bs=1M).\u003C\u002Fli\u003E\n\u003Cli\u003EO total de blocos foi especificado como 100 (através de count=100), ou seja, se temos blocos de 1 Mb e queremos 100 blocos, vamos ter um arquivo de 100 Mb.\u003C\u002Fli\u003E\n\u003C\u002Fol\u003E\n\u003Cp\u003EEsse comando deve rodar bem rápido e retornar algo similar à isso:\u003C\u002Fp\u003E\n\u003Cpre class=\"brush: text; gutter: true\"\u003E100+0 registros de entrada\r\n100+0 registros de saída\r\n104857600 bytes (105 MB) copiados, 0,0672096 s, 1,6 GB\u002Fs\r\n\u003C\u002Fpre\u003E\n\u003Ch2\u003EMontando o volume como um dispositivo de bloco\u003C\u002Fh2\u003E\n\u003Cp\u003EAgora temos que &#8220;montar&#8221; esse arquivo criado como se fosse um dispositivo de blocos. Para isso, vamos utilizar o comando \u003Ccode\u003Elosetup\u003C\u002Fcode\u003E, mas antes de montar, vamos ver quais dispositivos de blocos que temos disponíveis (reparem que vamos começar a utilizar o \u003Ccode\u003Esudo\u003C\u002Fcode\u003E para executar alguns comandos, alguns não precisam mas já fica garantido que se precisar, já tem autoridade):\u003C\u002Fp\u003E\n\u003Cpre class=\"brush: text; gutter: true\"\u003E$ sudo losetup -a\r\n$  \r\n\u003C\u002Fpre\u003E\n\u003Cp\u003EAqui o resultado foi vazio, indicando que não existem nenhum dispositivos do tipo montados. Quando é vazio, podemos começar a montar nossos dispositivos a partir do \u003Ccode\u003E0\u003C\u002Fcode\u003E, aproveitando para listar novamente:\u003C\u002Fp\u003E\n\u003Cpre class=\"brush: text; gutter: true\"\u003E$ sudo losetup \u002Fdev\u002Floop0 secret.img\r\n\r\n$ sudo losetup -a\r\n\u002Fdev\u002Floop0: [2049]:1967672 (\u002Ftmp\u002Fsecret.img)\r\n\u003C\u002Fpre\u003E\n\u003Ch2\u003EFormatando o volume\u003C\u002Fh2\u003E\n\u003Cp\u003EVamos formatar o volume indicando que deve usar o \u003Ccode\u003ELUKS\u003C\u002Fcode\u003E, com o utilitário \u003Ccode\u003Ecryptsetup\u003C\u002Fcode\u003E:\u003C\u002Fp\u003E\n\u003Cpre class=\"brush: text; gutter: true\"\u003E$ sudo cryptsetup luksFormat \u002Fdev\u002Floop0\r\n\r\nWARNING!\r\n========\r\nIsto irá sobrescrever os arquivos em \u002Fdev\u002Floop0 definitivamente.\r\n\r\nAre you sure? (Type uppercase yes): YES\r\nInforme a frase secreta: \r\nVerify passphrase: \r\n\u003C\u002Fpre\u003E\n\u003Cp\u003EAli é exibida uma parte muito importante do processo: a senha do volume. \u003Cstrong\u003ESe você perder a senha, já era, seus dados não vão estar mais acessíveis a não ser que você utilize uma senha muito fácil que possa ser quebrada por força bruta\u003C\u002Fstrong\u003E, mas senhas simples para um volume como esse não é o caso, não é mesmo? Utilize uma senha boa e que possa ser lembrada.\u003C\u002Fp\u003E\n\u003Ch2\u003EAbrindo o volume\u003C\u002Fh2\u003E\n\u003Cp\u003ETemos agora que abrir o volume encriptado, dando um nome à ele (eu costumo utilizar o mesmo nome do arquivo criado, sem a extensão, mas fica ao critério de cada um):\u003C\u002Fp\u003E\n\u003Cpre class=\"brush: text; gutter: true\"\u003E$ sudo cryptsetup luksOpen \u002Fdev\u002Floop0 secret\r\nInforme a frase secreta para \u002Ftmp\u002Fsecret.img:\r\n\u003C\u002Fpre\u003E\n\u003Ch2\u003ECriando o sistema de arquivos\u003C\u002Fh2\u003E\n\u003Cp\u003EPrecisamos montar um sistema de arquivos no volume já aberto. Vamos utilizar o \u003Ca href=\"https:\u002F\u002Fpt.wikipedia.org\u002Fwiki\u002FExt4\"\u003Eext4\u003C\u002Fa\u003E como sistema de arquivos e formatar utilizando o mkfs.ext4 (reparem que aqui utilizamos o mapper):\u003C\u002Fp\u003E\n\u003Cpre class=\"brush: text; gutter: true\"\u003E$ sudo mkfs.ext4 \u002Fdev\u002Fmapper\u002Fsecret\r\n\r\nmke2fs 1.42.12 (29-Aug-2014)\r\nCreating filesystem with 100352 1k blocks and 25168 inodes\r\nFilesystem UUID: 5733fdf2-9ef9-444e-9da3-043f95943c54\r\nCópias de segurança de superblocos gravadas em blocos: \r\n    8193, 24577, 40961, 57345, 73729\r\n\r\nAllocating group tables: pronto                            \r\nGravando tabelas inode: pronto                            \r\nCreating journal (4096 blocks): concluído\r\nEscrevendo superblocos e informações de contabilidade de sistema de arquivos:  0concluído\r\n\u003C\u002Fpre\u003E\n\u003Ch2\u003EMontando o sistema de arquivos\u003C\u002Fh2\u003E\n\u003Cp\u003EPrecisamos de algum local no sistema de arquivos atual para montar o volume já criado, formatado e com sistema de arquivos. Vamos criar um diretório novo e montar:\u003C\u002Fp\u003E\n\u003Cpre class=\"brush: text; gutter: true\"\u003E$ mkdir secret\r\n\r\n$ sudo mount \u002Fdev\u002Fmapper\u002Fsecret secret  \r\n\u003C\u002Fpre\u003E\n\u003Ch2\u003EDando permissões no sistema de arquivos\u003C\u002Fh2\u003E\n\u003Cp\u003EO sistema de arquivos foi criado com permissões apenas para o usuário \u003Ccode\u003Eroot\u003C\u002Fcode\u003E. Vamos corrigir isso entrando dentro do sistema de arquivos montado, ajustando as permissões para o usuário corrente e criando um arquivo novo para ver se ficou tudo ok:\u003C\u002Fp\u003E\n\u003Cpre class=\"brush: text; gutter: true\"\u003E$ cd secret\u002F\r\n\r\n[secret] $ ls\r\ntotal 33K\r\ndrwxr-xr-x  3 root root 1,0K Jun 27 09:47 .\r\ndrwxrwxrwt 22 root root  20K Jun 27 09:58 ..\r\ndrwx------  2 root root  12K Jun 27 09:47 lost+found\r\n\r\n[secret] $ sudo chown -Rv taq.taq .\r\nalterado o dono de “.\u002Flost+found” de root:root para taq:taq\r\nalterado o dono de “.” de root:root para taq:taq\r\n\r\n[secret] $ echo &quot;oi&quot; &amp;gt; teste.txt\r\n[secret] $ cat teste.txt\r\noi\r\n\u003C\u002Fpre\u003E\n\u003Ch2\u003EFechando tudo\u003C\u002Fh2\u003E\n\u003Cp\u003EAgora que tudo o que precisávamos para o volume está feito, podemos &#8220;fechar o boteco&#8221; (vejam que inicialmente eu estava dentro do diretório do volume montado, por isso que utilizei o \u003Ccode\u003Ecd\u003C\u002Fcode\u003E para sair):\u003C\u002Fp\u003E\n\u003Cpre\u003E[secret] $ cd ..\r\n\r\n$ sudo umount secret\r\n\r\n$ sudo cryptsetup luksClose secret\r\n\r\n$ sudo losetup -d \u002Fdev\u002Floop0\r\n\r\n$ sudo losetup -a\r\n\u003C\u002Fpre\u003E\n\u003Cp\u003EComo podemos ver no comando final, não existe mais nenhum dispositivo de blocos montado. Yay.\u003C\u002Fp\u003E\n\u003Ch2\u003EExtras muito importantes\u003C\u002Fh2\u003E\n\u003Cp\u003ETudo lindo e maravilhoso, mas aí você, como eu, insere uma senha &#8220;hacker-muito-macho-nunca-vou-esquecer-essa-bodega&#8221; e &#8230; esquece a dita cuja. Ou pior, você tem tudo certinho mas por alguma infelicidade do sistema de arquivos do seu disco rígido, o volume encriptado é corrompido, e aí?\u003C\u002Fp\u003E\n\u003Cp\u003EAntes de acontecer alguma situação nada agradável como essas, podemos garantir algumas coisas.\u003C\u002Fp\u003E\n\u003Ch2\u003EAdicionando uma senha extra\u003C\u002Fh2\u003E\n\u003Cp\u003EO Luks permite que tenhamos até 8 senhas (!!!) para o volume criado. Vamos dar uma olhada no cabeçalho do arquivo criado:\u003C\u002Fp\u003E\n\u003Cpre class=\"brush: text; gutter: true\"\u003E$ sudo cryptsetup luksDump secret.img \r\nLUKS header information for secret.img\r\n\r\nVersion:        1\r\nCipher name:    aes\r\nCipher mode:    xts-plain64\r\nHash spec:      sha1\r\nPayload offset: 4096\r\nMK bits:        256\r\nMK digest:      22 a2 74 61 50 61 7a 36 d6 af 70 be ce ee 33 fe d1 af 4c c8 \r\nMK salt:        7b 73 18 d3 20 0b 75 ad 9f 7d c4 f1 56 2d f0 10 \r\n                6e bd fe e5 e0 e9 8f 9d 9a 78 17 57 1c 9f 63 7d \r\nMK iterations:  108000\r\nUUID:           8f6d3b69-493a-4757-910b-5eba39b8a028\r\n\r\nKey Slot 0: ENABLED\r\n    Iterations:             432431\r\n    Salt:                   23 e9 5d f7 a4 e1 6d 6a 00 ba 33 d5 62 67 42 ab \r\n                            fb c0 4c 20 43 be 4b cc ea 63 38 fe 75 b3 e6 cb \r\n    Key material offset:    8\r\n    AF stripes:             4000\r\nKey Slot 1: DISABLED\r\nKey Slot 2: DISABLED\r\nKey Slot 3: DISABLED\r\nKey Slot 4: DISABLED\r\nKey Slot 5: DISABLED\r\nKey Slot 6: DISABLED\r\nKey Slot 7: DISABLED\r\n\u003C\u002Fpre\u003E\n\u003Cp\u003EPodemos ver ali que o \u003Cem\u003Eslot\u003C\u002Fem\u003E 0 está sendo utilizado, que é onde inserimos a senha quando formatamos o volume. Vamos pedir para adicionar mais uma senha:\u003C\u002Fp\u003E\n\u003Cpre class=\"brush: text; gutter: true\"\u003E$ sudo cryptsetup luksAddKey --key-slot 1 secret.img \r\nEnter any existing passphrase: \r\nDigite nova frase secreta para porta: \r\n\u003C\u002Fpre\u003E\n\u003Cp\u003EComo podemos ver, alguma das senhas já armazenadas é requisitada quando pedimos para adicionar uma senha nova, então \u003Cstrong\u003Efaça isso logo após criar o volume com a senha inicial\u003C\u002Fstrong\u003E! Dando uma olhada novamente no cabeçalho:\u003C\u002Fp\u003E\n\u003Cpre class=\"brush: text; gutter: true\"\u003E$ sudo cryptsetup luksDump secret.img \r\nLUKS header information for secret.img\r\n\r\nVersion:        1\r\nCipher name:    aes\r\nCipher mode:    xts-plain64\r\nHash spec:      sha1\r\nPayload offset: 4096\r\nMK bits:        256\r\nMK digest:      22 a2 74 61 50 61 7a 36 d6 af 70 be ce ee 33 fe d1 af 4c c8 \r\nMK salt:        7b 73 18 d3 20 0b 75 ad 9f 7d c4 f1 56 2d f0 10 \r\n                6e bd fe e5 e0 e9 8f 9d 9a 78 17 57 1c 9f 63 7d \r\nMK iterations:  108000\r\nUUID:           8f6d3b69-493a-4757-910b-5eba39b8a028\r\n\r\nKey Slot 0: ENABLED\r\n    Iterations:             432431\r\n    Salt:                   23 e9 5d f7 a4 e1 6d 6a 00 ba 33 d5 62 67 42 ab \r\n                            fb c0 4c 20 43 be 4b cc ea 63 38 fe 75 b3 e6 cb \r\n    Key material offset:    8\r\n    AF stripes:             4000\r\nKey Slot 1: ENABLED\r\n    Iterations:             407642\r\n    Salt:                   3d c0 ea 6c df f3 f0 37 b0 0e df b0 24 e9 ce 97 \r\n                            9c e5 38 75 ba 84 68 91 30 91 19 ae f3 21 51 86 \r\n    Key material offset:    264\r\n    AF stripes:             4000\r\nKey Slot 2: DISABLED\r\nKey Slot 3: DISABLED\r\nKey Slot 4: DISABLED\r\nKey Slot 5: DISABLED\r\nKey Slot 6: DISABLED\r\nKey Slot 7: DISABLED\r\n\u003C\u002Fpre\u003E\n\u003Cp\u003EPerfeito, o \u003Cem\u003Eslot\u003C\u002Fem\u003E 1 foi alocado. Vamos tentar abrir o volume agora com essa nova senha (fica a dica para a sequência de comandos, menos o ls e o cat, lógico, para a montagem dos volumes, utilizados ali somente para verificar se está tudo ok):\u003C\u002Fp\u003E\n\u003Cpre class=\"brush: text; gutter: true\"\u003E$ sudo losetup \u002Fdev\u002Floop0 secret.img \r\n\r\n$ sudo cryptsetup luksOpen \u002Fdev\u002Floop0 secret\r\nInforme a frase secreta para \u002Ftmp\u002Fsecret.img: \r\n\r\n$ sudo mount \u002Fdev\u002Fmapper\u002Fsecret secret\r\n\r\n$ ls secret\r\ntotal 34K\r\ndrwxr-xr-x  3 taq  taq  1,0K Jun 27 10:02 .\r\ndrwxrwxrwt 22 root root  20K Jun 27 10:18 ..\r\ndrwx------  2 taq  taq   12K Jun 27 09:47 lost+found\r\n-rw-rw-r--  1 taq  taq     3 Jun 27 10:02 teste.txt\r\n\r\n$ cat secret\u002Fteste.txt \r\noi\r\n\u003C\u002Fpre\u003E\n\u003Cp\u003ESenha extra funcionando corretamente.\u003C\u002Fp\u003E\n\u003Ch2\u003EFazendo um backup do cabeçalho\u003C\u002Fh2\u003E\n\u003Cp\u003EAí o seu disco rígido (interno, externo, \u003Cem\u003Ependrive\u003C\u002Fem\u003E ou onde seja que você armazenou o volume) dá algum tipo de problema e corrompe o seu arquivo. Vamos voltar no tempo e criar alguns resguardos em relação à isso. Antes de mais nada, vamos executar um teste para verificar se o cabeçalho do volume está ok:\u003C\u002Fp\u003E\n\u003Cpre class=\"brush: text; gutter: true\"\u003E$ sudo cryptsetup -v isLuks secret.img \r\nComando excutado com sucesso.\r\n\u003C\u002Fpre\u003E\n\u003Cp\u003EAparentemente, tudo ok. Agora vamos fazer o \u003Cem\u003Ebackup\u003C\u002Fem\u003E do cabeçalho para um arquivo:\u003C\u002Fp\u003E\n\u003Cpre class=\"brush: text; gutter: true\"\u003E$ sudo cryptsetup luksHeaderBackup secret.img --header-backup-file secret.header\r\n\u003C\u002Fpre\u003E\n\u003Cp\u003EIsso gera um arquivo chamado secret.header que pode ser mais tarde utilizado para recuperar o cabeçalho do volume. \u003Cstrong\u003EArmazene esse cabeçalho em um local seguro!\u003C\u002Fstrong\u003E\u003C\u002Fp\u003E\n\u003Ch2\u003ERemovendo o cabeçalho\u003C\u002Fh2\u003E\n\u003Cp\u003EMas que diabos, se logo ali acima estamos tentando dar um jeito de preservar o cabeçalho, para que remover o dito cujo? Simples: para que ninguém saiba que aquele volume é um volume LUKS. 🙂\u003C\u002Fp\u003E\n\u003Cp\u003EUm cabeçalho LUKS é facilmente identificável com os bytes logo no começo do volume:\u003C\u002Fp\u003E\n\u003Cpre\u003E$ hexdump -C secret.img | less\r\n00000000  4c 55 4b 53 ba be 00 01  61 65 73 00 00 00 00 00  |LUKS....aes.....|\r\n00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|\r\n00000020  00 00 00 00 00 00 00 00  78 74 73 2d 70 6c 61 69  |........xts-plai|\r\n...\r\n\u003C\u002Fpre\u003E\n\u003Cp\u003EPodemos remover e depois restaurar com a cópia que fizemos acima. Para isso vamos apagar os primeiros bytes do arquivo, no tamanho do cabeçalho que foi salvo anteriormente, verificado no primeiro comando:\u003C\u002Fp\u003E\n\u003Cpre\u003E$ sudo wc -c secret.header | cut -f1 -d&#039; &#039;\r\n1049600\r\n\r\n$ dd conv=notrunc if=\u002Fdev\u002Fzero of=secret.img bs=1 count=1049600\r\n1049600+0 registros de entrada\r\n1049600+0 registros de saída\r\n1049600 bytes (1,0 MB) copiados, 0,958486 s, 1,1 MB\u002Fs\u003C\u002Fpre\u003E\n\u003Cp\u003EVerificando novamente se é um volume LUKS\u003Ccode\u003E\u003C\u002Fcode\u003E válido:\u003C\u002Fp\u003E\n\u003Cpre class=\"brush: text; gutter: true\"\u003E$ sudo cryptsetup -v isLuks secret.img \r\nO dispositivo secret.img não é um dispositivo LUKS válido.\r\nFalha no comando com código 22: O dispositivo secret.img não é um dispositivo LUKS válido\r\n\u003C\u002Fpre\u003E\n\u003Ch2\u003ERestaurando o cabeçalho\u003C\u002Fh2\u003E\n\u003Cp\u003EAgora vamos restaurar o cabeçalho:\u003C\u002Fp\u003E\n\u003Cpre class=\"brush: text; gutter: true\"\u003E$ sudo cryptsetup luksHeaderRestore secret.img --header-backup-file secret.header \r\n[sudo] password for taq: \r\n\r\nWARNING!\r\n========\r\nDispositivo secret.img não contém um cabeçalho LUKS. Substituindo o cabeçalho pode destruir os dados no dispositivo.\r\n\r\nAre you sure? (Type uppercase yes): YES\r\n\u003C\u002Fpre\u003E\n\u003Cp\u003EVerificando novamente:\u003C\u002Fp\u003E\n\u003Cpre class=\"brush: text; gutter: true\"\u003E$ sudo cryptsetup -v isLuks secret.img \r\nComando excutado com sucesso.\r\n\r\n$ sudo losetup \u002Fdev\u002Floop0 secret.img \r\n\r\n$ sudo cryptsetup luksOpen \u002Fdev\u002Floop0 secret\r\nInforme a frase secreta para \u002Ftmp\u002Fsecret.img: \r\n\r\n$ sudo mount \u002Fdev\u002Fmapper\u002Fsecret secret\r\n\r\n$ ls secret\r\ntotal 34K\r\ndrwxr-xr-x  3 taq  taq  1,0K Jun 27 10:02 .\r\ndrwxrwxrwt 22 root root  20K Jun 27 12:29 ..\r\ndrwx------  2 taq  taq   12K Jun 27 09:47 lost+found\r\n-rw-rw-r--  1 taq  taq     3 Jun 27 10:02 teste.txt\r\n\r\n$ cat secret\u002Fteste.txt \r\noi\r\n\u003C\u002Fpre\u003E\n","excerpt":"\u003Cp\u003EEsses dias eu precisei montar um volume encriptado para gravar algumas informações que achava interessante ficarem isoladas do restante do disco. Apenas algumas coisas que às vezes aparecem que não acho interessante gravar como de costume no Evernote ou armazenar no Google Drive. \u003C\u002Fp\u003E\n","link":"https:\u002F\u002Fimasters.com.br\u002Fdevsecops\u002Fcriando-volumes-encriptados-com-luks-no-gnulinux","date":"3 set, 2015","thumbnail":"","externalMention":null,"author":{"id":6965,"thumbnail":"https:\u002F\u002Fsecure.gravatar.com\u002Favatar\u002F36a7207dc8c3974a330919128af15cc9?s=96&d=mm&r=g","name":"Eustáquio Rangel","description":"é desenvolvedor Java, PHP e Ruby, que é seu principal foco desde 2004 e que lhe rendeu um livro.","slug":"eustaquio_rangel","url":"\u002Fperfil\u002Feustaquio_rangel","registered":"2009-02-10 17:47:52","social":{"linkedin":null,"youtube":null,"facebook":null,"twitter":null,"instagram":null,"github":null},"articles_count":12,"views_count":15192,"certifications":null,"conquests":null,"office":null},"categories":[{"title":"DevSecOps","slug":"devsecops","id":1,"link":"https:\u002F\u002Fimasters.com.br\u002Fdevsecops"},{"title":"Linux","slug":"linux","id":7237,"link":"https:\u002F\u002Fimasters.com.br\u002Fdevsecops\u002Flinux"},{"title":"Segurança","slug":"seguranca","id":7269,"link":"https:\u002F\u002Fimasters.com.br\u002Fdevsecops\u002Fseguranca"}],"tags":[{"title":"gnu\u002Flinux","slug":"gnulinux","id":4195,"link":"https:\u002F\u002Fimasters.com.br\u002Fgnulinux"},{"title":"infra","slug":"infra-2","id":2506,"link":"https:\u002F\u002Fimasters.com.br\u002Finfra-2"},{"title":"linux","slug":"linux-2","id":278,"link":"https:\u002F\u002Fimasters.com.br\u002Flinux-2"},{"title":"luks","slug":"luks","id":4194,"link":"https:\u002F\u002Fimasters.com.br\u002Fluks"},{"title":"segurança","slug":"seguranca-2","id":298,"link":"https:\u002F\u002Fimasters.com.br\u002Fseguranca-2"},{"title":"volumes encriptados","slug":"volumes-encriptados","id":4196,"link":"https:\u002F\u002Fimasters.com.br\u002Fvolumes-encriptados"}],"seo":{"open_graph":{"title":"Criando volumes encriptados com LUKS no GNU\u002FLinux - iMasters - We are Developers","description":"Esses dias eu precisei montar um volume encriptado para gravar algumas informações que achava interessante ficarem isoladas do restante do disco. Apenas algumas coisas que às vezes aparecem que não acho interessante gravar como de costume no Evernote ou armazenar no Google Drive.","type":"article","locale":"pt_BR","site_name":"iMasters - We are Developers","image":false,"modified_time":"2018-05-24T01:36:39-03:00","published_time":"2015-09-03T11:00:00-03:00"},"twitter":{"title":"Criando volumes encriptados com LUKS no GNU\u002FLinux - iMasters - We are Developers","description":"Esses dias eu precisei montar um volume encriptado para gravar algumas informações que achava interessante ficarem isoladas do restante do disco. Apenas algumas coisas que às vezes aparecem que não acho interessante gravar como de costume no Evernote ou armazenar no Google Drive.","type":"summary_large_image","image":false}},"type":"post"},{"id":80876,"title":"Referências circulares no Ruby 2.2.x","content":"\u003Cp\u003EEu estava para escrever esse artigo faz algum tempo, desde que saiu a versão 2.2.0 da linguagem Ruby, mas nunca dava tempo&#8230; Até que, rodando um projeto nessa versão, me lembrei de um detalhe importante, já consertado em gems mais novas, mas que vale a pena alertar.\u003C\u002Fp\u003E\n\u003Cp\u003EVamos considerar o seguinte código:\u003C\u002Fp\u003E\n\u003Cpre class=\"brush: text; gutter: true\"\u003Eclass FooBar\r\n  def foo\r\n    &quot;I&#039;m in foo!&quot;\r\n  end\r\n \r\n  def bar(foo = foo)\r\n    puts foo\r\n  end\r\nend\r\n \r\nfoobar = FooBar.new\r\nfoobar.bar\r\nfoobar.bar(&quot;Not using foo!&quot;)\u003C\u002Fpre\u003E\n\u003Cp\u003EPodemos ver que temos dois métodos ali: \u003Ccode\u003Efoo\u003C\u002Fcode\u003E, que retorna uma \u003Ccode\u003EString\u003C\u002Fcode\u003E, e \u003Ccode\u003Ebar\u003C\u002Fcode\u003E, que utiliza um argumento com valor \u003Cem\u003Edefault\u003C\u002Fem\u003E, que no caso de não ter sido enviado, vai utilizar o retorno de \u003Ccode\u003Efoo\u003C\u002Fcode\u003E. Rodando o código em uma versão menor que 2.2.x, é exibido o seguinte resultado:\u003C\u002Fp\u003E\n\u003Cpre\u003E&lt;code&gt;$ ruby circular.rb \r\nI&#039;m in foo!\r\nNot using foo!\r\n&lt;\u002Fcode&gt;\u003C\u002Fpre\u003E\n\u003Cp\u003EMas, rodando a partir da versão \u003Ccode\u003E2.2.0\u003C\u002Fcode\u003E, temos o seguinte resultado:\u003C\u002Fp\u003E\n\u003Cpre\u003E&lt;code&gt;$ ruby circular.rb                                                                                                                                          \r\ncircular.rb:6: warning: circular argument reference - foo\r\n\r\nNot using foo!\r\n&lt;\u002Fcode&gt;\u003C\u002Fpre\u003E\n\u003Cp\u003EO que ocorre é que, a partir da versão \u003Ccode\u003E2.2.0\u003C\u002Fcode\u003E, \u003Cstrong\u003Eo argumento\u003C\u002Fstrong\u003E \u003Ccode\u003Efoo\u003C\u002Fcode\u003E (à esquerda) está procurando uma \u003Cstrong\u003Evariável\u003C\u002Fstrong\u003E \u003Ccode\u003Efoo\u003C\u002Fcode\u003E (à direita), e como ela não existe e seria ali uma referência para a própria variável que está sendo criada na assinatura do método (daí a referência circular), é atribuído o valor de \u003Ccode\u003Enil\u003C\u002Fcode\u003E e disparado um \u003Cem\u003Ewarning\u003C\u002Fem\u003E.\u003C\u002Fp\u003E\n\u003Cp\u003EPara utilizar o comportamento anterior nas versões a partir de \u003Ccode\u003E2.2.x\u003C\u002Fcode\u003E, temos que fazer uma referência explícita ao método \u003Ccode\u003Efoo\u003C\u002Fcode\u003E na linha 6, da seguinte maneira:\u003C\u002Fp\u003E\n\u003Cpre\u003E&lt;code&gt;  def bar(foo = foo())\r\n&lt;\u002Fcode&gt;\u003C\u002Fpre\u003E\n\u003Cp\u003EAlgumas \u003Cem\u003Egems\u003C\u002Fem\u003E do Rails, dependendo da versão, estavam com esse tipo de problema (como por exemplo, o \u003Ca href=\"http:\u002F\u002Feustaquiorangel.com\u002Fposts\u002Freferencias_circulares_no_ruby_2_2_x\"\u003EActiveSupport\u003C\u002Fa\u003E), mas aparentemente em versões atuais, já foi resolvido. Na hora que forem rodar seus projetos com versões novas do Ruby a partir das \u003Ccode\u003E2.2.x\u003C\u002Fcode\u003E, fiquem espertos com isso.\u003C\u002Fp\u003E\n","excerpt":"\u003Cp\u003ERodando um projeto nessa versão, me lembrei de um detalhe importante, já consertado em gems mais novas, mas que vale a pena alertar.\u003C\u002Fp\u003E\n","link":"https:\u002F\u002Fimasters.com.br\u002Fback-end\u002Freferencias-circulares-no-ruby-2-2-x","date":"19 mai, 2015","thumbnail":"","externalMention":null,"author":{"id":6965,"thumbnail":"https:\u002F\u002Fsecure.gravatar.com\u002Favatar\u002F36a7207dc8c3974a330919128af15cc9?s=96&d=mm&r=g","name":"Eustáquio Rangel","description":"é desenvolvedor Java, PHP e Ruby, que é seu principal foco desde 2004 e que lhe rendeu um livro.","slug":"eustaquio_rangel","url":"\u002Fperfil\u002Feustaquio_rangel","registered":"2009-02-10 17:47:52","social":{"linkedin":null,"youtube":null,"facebook":null,"twitter":null,"instagram":null,"github":null},"articles_count":12,"views_count":15192,"certifications":null,"conquests":null,"office":null},"categories":[{"title":"Back-End","slug":"back-end","id":7158,"link":"https:\u002F\u002Fimasters.com.br\u002Fback-end"},{"title":"Ruby","slug":"ruby","id":7231,"link":"https:\u002F\u002Fimasters.com.br\u002Flinguagens\u002Fruby"}],"tags":[{"title":"linguagem","slug":"linguagem","id":539,"link":"https:\u002F\u002Fimasters.com.br\u002Flinguagem"},{"title":"ruby","slug":"ruby-2","id":389,"link":"https:\u002F\u002Fimasters.com.br\u002Fruby-2"}],"seo":{"open_graph":{"title":"Referências circulares no Ruby 2.2.x - iMasters - We are Developers","description":"Rodando um projeto nessa versão, me lembrei de um detalhe importante, já consertado em gems mais novas, mas que vale a pena alertar.","type":"article","locale":"pt_BR","site_name":"iMasters - We are Developers","image":false,"modified_time":"2018-05-24T12:11:07-03:00","published_time":"2015-05-19T09:00:49-03:00"},"twitter":{"title":"Referências circulares no Ruby 2.2.x - iMasters - We are Developers","description":"Rodando um projeto nessa versão, me lembrei de um detalhe importante, já consertado em gems mais novas, mas que vale a pena alertar.","type":"summary_large_image","image":false}},"type":"post"},{"id":59330,"title":"Utilizando PHP, PDO e Oracle","content":"\u003Cp\u003EQuem já precisou utilizar \u003Ca href=\"http:\u002F\u002Fwww.php.net\u002F\"\u003EPHP\u003C\u002Fa\u003E com \u003Ca href=\"http:\u002F\u002Fphp.net\u002Fpdo?\"\u003EPDO\u003C\u002Fa\u003E e o \u003Ca href=\"http:\u002F\u002Fwww.oracle.com\u002F\"\u003EOracle\u003C\u002Fa\u003E sabe que é uma tarefa meio que chatinha, para dizer o mínimo. A \u003Ca href=\"http:\u002F\u002Fpecl.php.net\u002Fpackage\u002FPDO_OCI\"\u003Einterface instalável através do \u003Ctt\u003Epecl\u003C\u002Ftt\u003E não é mais mantida desde 2005\u003C\u002Fa\u003E e \u003Ca href=\"http:\u002F\u002Fbr1.php.net\u002Fmanual\u002Fen\u002Fref.pdo-oci.php\"\u003Eextensão do PHP\u003C\u002Fa\u003E está em &#8220;experimental&#8221; sabe-se lá desde quando, e pede para que o PHP seja compilado. Compilar tudo bem. Onde se pode compilar é outra história&#8230;\u003C\u002Fp\u003E\n\u003Cp\u003EPara descomplicar tudo isso fiz o \u003Ca href=\"https:\u002F\u002Fgithub.com\u002Ftaq\u002Fpdooci\"\u003EPDOOCI\u003C\u002Fa\u003E. Só precisa que os drivers do Oracle estejam instalados, ou seja, o PHP tem acesso as funções\u003Ctt\u003Eoci_*\u003C\u002Ftt\u003E, e que o próprio PDO esteja presente &#8211; isso é para manter a compatibilidade, se por acaso esse novo módulo for substituir algum já implementado, que espera, por exemplo, algumas exceções do PDO.\u003C\u002Fp\u003E\n\u003Cp\u003EPara instalar é muito simples: só copie os arquivos do repositório e faça um \u003Ctt\u003Einclude\u003C\u002Ftt\u003E, \u003Ctt\u003Erequire\u003C\u002Ftt\u003E, \u003Ctt\u003Einclude_once\u003C\u002Ftt\u003E ou \u003Ctt\u003Erequire_once\u003C\u002Ftt\u003E (de acordo com a preferência) no arquivo \u003Ctt\u003Epdooci.php\u003C\u002Ftt\u003E, e substitua algum código já existente de:\u003C\u002Fp\u003E\n\u003Cpre\u003E$pdo = new PDO(&quot;oci:dbname=mydatabase;charset=utf8&quot;, &quot;user&quot;, &quot;password&quot;);\u003C\u002Fpre\u003E\n\u003Cp\u003Epara:\u003C\u002Fp\u003E\n\u003Cpre\u003E$pdo = new PDOOCI\\PDO(&quot;mydatabase;charset=utf8&quot;, &quot;user&quot;, &quot;password&quot;);\u003C\u002Fpre\u003E\n\u003Cp\u003EPronto! Não precisa nem hackear nem compilar mais nada.\u003C\u002Fp\u003E\n","excerpt":"\u003Cp\u003EQuem já precisou utilizar PHP com PDO e o Oracle sabe que é uma tarefa meio que chatinha. Tentei criar um método fácil de realizar essa tarefa.\u003C\u002Fp\u003E\n","link":"https:\u002F\u002Fimasters.com.br\u002Fback-end\u002Futilizando-php-pdo-e-oracle","date":"13 mai, 2014","thumbnail":"","externalMention":null,"author":{"id":6965,"thumbnail":"https:\u002F\u002Fsecure.gravatar.com\u002Favatar\u002F36a7207dc8c3974a330919128af15cc9?s=96&d=mm&r=g","name":"Eustáquio Rangel","description":"é desenvolvedor Java, PHP e Ruby, que é seu principal foco desde 2004 e que lhe rendeu um livro.","slug":"eustaquio_rangel","url":"\u002Fperfil\u002Feustaquio_rangel","registered":"2009-02-10 17:47:52","social":{"linkedin":null,"youtube":null,"facebook":null,"twitter":null,"instagram":null,"github":null},"articles_count":12,"views_count":15192,"certifications":null,"conquests":null,"office":null},"categories":[{"title":"Back-End","slug":"back-end","id":7158,"link":"https:\u002F\u002Fimasters.com.br\u002Fback-end"},{"title":"Data","slug":"data","id":16,"link":"https:\u002F\u002Fimasters.com.br\u002Fdata"},{"title":"Oracle","slug":"oracle","id":7216,"link":"https:\u002F\u002Fimasters.com.br\u002Fbanco-de-dados\u002Fdata\u002Foracle"},{"title":"PHP","slug":"php","id":7224,"link":"https:\u002F\u002Fimasters.com.br\u002Flinguagens\u002Fphp"}],"tags":[{"title":"banco de dados","slug":"banco-de-dados-2","id":189,"link":"https:\u002F\u002Fimasters.com.br\u002Fbanco-de-dados-2"},{"title":"oracle","slug":"oracle-2","id":216,"link":"https:\u002F\u002Fimasters.com.br\u002Foracle-2"},{"title":"pdo","slug":"pdo","id":705,"link":"https:\u002F\u002Fimasters.com.br\u002Fpdo"},{"title":"php","slug":"php-2","id":326,"link":"https:\u002F\u002Fimasters.com.br\u002Fphp-2"}],"seo":{"open_graph":{"title":"Utilizando PHP, PDO e Oracle - iMasters - We are Developers","description":"Quem já precisou utilizar PHP com PDO e o Oracle sabe que é uma tarefa meio que chatinha. Tentei criar um método fácil de realizar essa tarefa.","type":"article","locale":"pt_BR","site_name":"iMasters - We are Developers","image":false,"modified_time":"2018-05-23T23:31:16-03:00","published_time":"2014-05-13T14:00:17-03:00"},"twitter":{"title":"Utilizando PHP, PDO e Oracle - iMasters - We are Developers","description":"Quem já precisou utilizar PHP com PDO e o Oracle sabe que é uma tarefa meio que chatinha. Tentei criar um método fácil de realizar essa tarefa.","type":"summary_large_image","image":false}},"type":"post"},{"id":38370,"title":"Identificando o tipo MIME em Ruby","content":"\u003Cp\u003EEstou trabalhando em um projeto onde temos que identificar os tipos \u003Ca href=\"http:\u002F\u002Fpt.wikipedia.org\u002Fwiki\u002FMIME\"\u003EMIME\u003C\u002Fa\u003E dos arquivos enviados corretamente (fora do \u003Cem\u003Econtroller\u003C\u002Fem\u003E, que tem o \u003Ctt\u003Econtent_type\u003C\u002Ftt\u003E enviado), e em alguns dos testes feitos (vocês fazem testes, correto?) foi identificado que o tipo incorreto de um arquivo estava passando, sendo &#8220;ludiabriado&#8221; apenas trocando a extensão do arquivo.\u003C\u002Fp\u003E\n\u003Cp\u003EVerificando a \u003Cem\u003Egem\u003C\u002Fem\u003E que eu estava utilizando, vi que ela, como tantas outras, levava em conta a extensão do arquivo para retornar o MIME, o que achei bem frágil. Era só copiar um \u003Ctt\u003E.jpg\u003C\u002Ftt\u003E como \u003Ctt\u003E.zip\u003C\u002Ftt\u003E para ele retornar o tipo como \u003Ctt\u003Eapplication\u002Fzip.\u003C\u002Ftt\u003E\u003C\u002Fp\u003E\n\u003Cp\u003EFoi aí que encontrei a \u003Ca href=\"http:\u002F\u002Frubygems.org\u002Fgems\u002Fmahoro\"\u003EMahoro\u003C\u002Fa\u003E. Ela se utiliza do funcionamento da \u003Ca href=\"http:\u002F\u002Flinux.die.net\u002Fman\u002F3\u002Flibmagic\"\u003Elibmagic\u003C\u002Fa\u003E (ei, não é a \u003Ca href=\"http:\u002F\u002Fwww.imagemagick.org\u002F\"\u003EImageMagick\u003C\u002Fa\u003E, hein?!), que utiliza o mesmo princípio de identificação de arquivos que o comando \u003Ca href=\"http:\u002F\u002Flinux.die.net\u002Fman\u002F1\u002Ffile\"\u003Efile\u003C\u002Fa\u003E, que é um &#8220;sistema de padrões mágicos&#8221;, como descrito:\u003C\u002Fp\u003E\n\u003Cblockquote\u003E\u003Cp\u003EThe file(1) command identifies the type of a file using, among other tests, a test for whether the file contains certain &#8221;magic patterns&#8221;. The file \u002Fusr\u002Fshare\u002Fmisc\u002Fmagic specifies what patterns are to be tested for, what message or MIME type to print if a particular pattern is found, and additional information to extract from the file.\u003C\u002Fp\u003E\u003C\u002Fblockquote\u003E\n\u003Cp\u003EPara instalar a \u003Cem\u003Egem\u003C\u002Fem\u003E, é necessário algumas \u003Cem\u003Elibs\u003C\u002Fem\u003E, que no \u003Ca href=\"http:\u002F\u002Fubuntu.com\"\u003EUbuntu\u003C\u002Fa\u003E são:\u003C\u002Fp\u003E\n\u003Cpre\u003Esudo apt-get install libmagic1 libmagic-dev\u003C\u002Fpre\u003E\n\u003Cp\u003EPara usar depois, bem fácil, pegando de exemplo um \u003Ctt\u003E.zip\u003C\u002Ftt\u003E que copiei como \u003Ctt\u003E.jpg\u003C\u002Ftt\u003E:\u003C\u002Fp\u003E\n\u003Cpre\u003Erequire &quot;mahoro&quot;\r\nMahoro.new(Mahoro::MIME).file(&quot;\u002Ftmp\u002Fcaca.jpg&quot;).split(&quot;;&quot;)[0]\u003C\u002Fpre\u003E\n\u003Cp\u003EIsso retorna corretamente \u003Ctt\u003Eapplication\u002Fzip\u003C\u002Ftt\u003E. Vale lembrar que, acredito eu, que isso não funcionará em sistemas Windows (mas você não está rodando o seu projeto lá, está?!).\u003C\u002Fp\u003E\n","excerpt":"\u003Cp\u003EEstou trabalhando em um projeto onde temos que identificar os tipos MIME dos arquivos enviados corretamente foi identificado que o tipo incorreto de um arquivo estava passando, sendo &quot;ludiabriado&quot; apenas trocando a extensão do arquivo. Veja como resolvi o problema.\u003C\u002Fp\u003E\n","link":"https:\u002F\u002Fimasters.com.br\u002Fback-end\u002Fidentificando-o-tipo-mime-em-ruby","date":"1 mar, 2013","thumbnail":"","externalMention":null,"author":{"id":6965,"thumbnail":"https:\u002F\u002Fsecure.gravatar.com\u002Favatar\u002F36a7207dc8c3974a330919128af15cc9?s=96&d=mm&r=g","name":"Eustáquio Rangel","description":"é desenvolvedor Java, PHP e Ruby, que é seu principal foco desde 2004 e que lhe rendeu um livro.","slug":"eustaquio_rangel","url":"\u002Fperfil\u002Feustaquio_rangel","registered":"2009-02-10 17:47:52","social":{"linkedin":null,"youtube":null,"facebook":null,"twitter":null,"instagram":null,"github":null},"articles_count":12,"views_count":15192,"certifications":null,"conquests":null,"office":null},"categories":[{"title":"Back-End","slug":"back-end","id":7158,"link":"https:\u002F\u002Fimasters.com.br\u002Fback-end"},{"title":"Ruby","slug":"ruby","id":7231,"link":"https:\u002F\u002Fimasters.com.br\u002Flinguagens\u002Fruby"}],"tags":[{"title":"desenvolvimento","slug":"desenvolvimento-2","id":186,"link":"https:\u002F\u002Fimasters.com.br\u002Fdesenvolvimento-2"},{"title":"mime","slug":"mime","id":1291,"link":"https:\u002F\u002Fimasters.com.br\u002Fmime"},{"title":"ruby","slug":"ruby-2","id":389,"link":"https:\u002F\u002Fimasters.com.br\u002Fruby-2"}],"seo":{"open_graph":{"title":"Identificando o tipo MIME em Ruby - iMasters - We are Developers","description":"Estou trabalhando em um projeto onde temos que identificar os tipos MIME dos arquivos enviados corretamente foi identificado que o tipo incorreto de um arquivo estava passando, sendo &quot;ludiabriado&quot; apenas trocando a extensão do arquivo. Veja como resolvi o problema.","type":"article","locale":"pt_BR","site_name":"iMasters - We are Developers","image":false,"modified_time":"2018-05-24T12:11:18-03:00","published_time":"2013-03-01T10:00:18-03:00"},"twitter":{"title":"Identificando o tipo MIME em Ruby - iMasters - We are Developers","description":"Estou trabalhando em um projeto onde temos que identificar os tipos MIME dos arquivos enviados corretamente foi identificado que o tipo incorreto de um arquivo estava passando, sendo &quot;ludiabriado&quot; apenas trocando a extensão do arquivo. Veja como resolvi o problema.","type":"summary_large_image","image":false}},"type":"post"},{"id":12468,"title":"Validando XML com Ruby","content":"\u003Cp\u003E\nRecebi um email me perguntando como fazer validação de um arquivo XML com Ruby, usando \u003Ca href=\"http:\u002F\u002Fwww.w3.org\u002FXML\u002FSchema\" class=\"ext\"\u003EXML\u003C\u002Fa\u003E \u003Ca href=\"http:\u002F\u002Fpt.wikipedia.org\u002Fwiki\u002FXML_Schema\" class=\"ext\"\u003ESchema\u003C\u002Fa\u003E.\u003Cbr \u002F\u003E\nFui honesto e disse que eu nunca havia precisado usar esse lance em\u003Cbr \u002F\u003E\nRuby mas fiquei curioso sobre como fazer, já que algum tempo atrás usei\u003Cbr \u002F\u003E\nalgo similar em PHP. Vamos dar uma olhada em como fazer alguma coisa\u003Cbr \u002F\u003E\ndisso.\n\u003C\u002Fp\u003E\n\u003Cp\u003E\nAntes de mais nada, precisamos dos arquivos. Vou usar esse XML bem simples, que chamei de \u003Cstrong\u003Ecatalogo.xml\u003C\u002Fstrong\u003E:\n\u003C\u002Fp\u003E\n\u003Cdiv class=\"codigo\"\u003E\n\u003Cpre\u003E\u003Ccode\u003E &lt;?xml version=\"1.0\"?&gt;\u003Cbr \u002F\u003E &lt;catalogo loja=\"Livraria O Quarto Homem\" ano=\"2009\"&gt;\u003Cbr \u002F\u003E    &lt;categorias&gt;\u003Cbr \u002F\u003E       &lt;categoria titulo=\"ficcao\"&gt;\u003Cbr \u002F\u003E          &lt;livro&gt;\u003Cbr \u002F\u003E             &lt;titulo&gt;A Voz do Fogo&lt;\u002Ftitulo&gt;\u003Cbr \u002F\u003E             &lt;autor&gt;Alan Moore&lt;\u002Fautor&gt;\u003Cbr \u002F\u003E          &lt;\u002Flivro&gt;\u003Cbr \u002F\u003E       &lt;\u002Fcategoria&gt;\u003Cbr \u002F\u003E    &lt;\u002Fcategorias&gt;\u003Cbr \u002F\u003E &lt;\u002Fcatalogo&gt;\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003C\u002Fdiv\u003E\n\u003Cp\u003E\nAgora vamos começar a construir o arquivo XSD para a validação, tipo esse que chamei de \u003Cstrong\u003Ecatalogo.xsd\u003C\u002Fstrong\u003E:\n\u003C\u002Fp\u003E\n\u003Cdiv class=\"codigo\"\u003E\n\u003Cpre\u003E\u003Ccode\u003E &lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;\u003Cbr \u002F\u003E &lt;xs:schema xmlns:xs=\"\u003Ca href=\"http:\u002F\u002Fwww.w3.org\u002F2001\u002FXMLSchema\" class=\"ext\"\u003Ehttp:\u002F\u002Fwww.w3.org\u002F2001\u002FXMLSchema\u003C\u002Fa\u003E\"&gt;\u003Cbr \u002F\u003E     &lt;xs:element name=\"catalogo\"&gt;\u003Cbr \u002F\u003E       &lt;xs:complexType&gt;\u003Cbr \u002F\u003E          &lt;xs:sequence&gt;\u003Cbr \u002F\u003E             &lt;xs:element ref=\"categorias\" minOccurs=\"1\" maxOccurs=\"unbounded\"\u002F&gt;\u003Cbr \u002F\u003E          &lt;\u002Fxs:sequence&gt;\u003Cbr \u002F\u003E          &lt;xs:attribute name=\"loja\" type=\"xs:string\"\u002F&gt;\u003Cbr \u002F\u003E          &lt;xs:attribute name=\"ano\"  type=\"xs:integer\"\u002F&gt;\u003Cbr \u002F\u003E       &lt;\u002Fxs:complexType&gt;\u003Cbr \u002F\u003E    &lt;\u002Fxs:element&gt;\u003Cbr \u002F\u003E \u003Cbr \u002F\u003E    &lt;xs:element name=\"categorias\"&gt;\u003Cbr \u002F\u003E       &lt;xs:complexType&gt;\u003Cbr \u002F\u003E          &lt;xs:sequence&gt;\u003Cbr \u002F\u003E             &lt;xs:element ref=\"categoria\" minOccurs=\"1\" maxOccurs=\"unbounded\"\u002F&gt;\u003Cbr \u002F\u003E          &lt;\u002Fxs:sequence&gt;\u003Cbr \u002F\u003E       &lt;\u002Fxs:complexType&gt;\u003Cbr \u002F\u003E    &lt;\u002Fxs:element&gt;\u003Cbr \u002F\u003E \u003Cbr \u002F\u003E    &lt;xs:element name=\"categoria\"&gt;\u003Cbr \u002F\u003E       &lt;xs:complexType&gt;\u003Cbr \u002F\u003E          &lt;xs:sequence&gt;\u003Cbr \u002F\u003E             &lt;xs:element ref=\"livro\" minOccurs=\"1\" maxOccurs=\"unbounded\"\u002F&gt;\u003Cbr \u002F\u003E          &lt;\u002Fxs:sequence&gt;\u003Cbr \u002F\u003E          &lt;xs:attribute name=\"titulo\" type=\"xs:string\"\u002F&gt;\u003Cbr \u002F\u003E       &lt;\u002Fxs:complexType&gt;\u003Cbr \u002F\u003E    &lt;\u002Fxs:element&gt;\u003Cbr \u002F\u003E \u003Cbr \u002F\u003E    &lt;xs:element name=\"livro\"&gt;\u003Cbr \u002F\u003E       &lt;xs:complexType&gt;\u003Cbr \u002F\u003E          &lt;xs:sequence&gt;\u003Cbr \u002F\u003E             &lt;xs:element name=\"titulo\" type=\"xs:string\"\u002F&gt;\u003Cbr \u002F\u003E             &lt;xs:element name=\"autor\" type=\"xs:string\"\u002F&gt;\u003Cbr \u002F\u003E          &lt;\u002Fxs:sequence&gt;\u003Cbr \u002F\u003E       &lt;\u002Fxs:complexType&gt;\u003Cbr \u002F\u003E    &lt;\u002Fxs:element&gt;\u003Cbr \u002F\u003E &lt;\u002Fxs:schema&gt;\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003C\u002Fdiv\u003E\n\u003Cp\u003EOk, até agora nenhum segredo. Arquivos básicos com validação básica.\u003Cbr \u002F\u003E\nO lance agora é: como vamos usar Ruby para validar esse XML com esse\u003Cbr \u002F\u003E\nXSD? Eu escolhi usar a \u003Ca href=\"http:\u002F\u002Flibxml.rubyforge.org\u002Frdoc\u002Findex.html\" class=\"ext\"\u003Elibxml-ruby\u003C\u002Fa\u003E. Para instalá-la, apenas um\n\u003C\u002Fp\u003E\n\u003Cdiv class=\"codigo\"\u003E\n\u003Cpre\u003E\u003Ccode\u003Egem install libxml-ruby\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003C\u002Fdiv\u003E\n\u003Cp\u003E\ne está tudo pronto para começarmos a fazer o nosso código de validação. No site da libxml-ruby há uma documentação ótima, mas vou dar uma resumida na coisa. Criei um arquivo chamado \u003Ctt\u003Exsd.rb\u003C\u002Ftt\u003E com o seguinte código dentro:\n\u003C\u002Fp\u003E\n\u003Cdiv class=\"codigo\"\u003E\n\u003Cpre\u003E\u003Ccode\u003E require \"rubygems\"\u003Cbr \u002F\u003E require \"xml\"\u003Cbr \u002F\u003E \u003Cbr \u002F\u003E xml = XML::Document.file(ARGV[0])\u003Cbr \u002F\u003E schema = XML::Schema.document(XML::Document.file(ARGV[1]))\u003Cbr \u002F\u003E puts xml.validate_schema(schema)\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003C\u002Fdiv\u003E\n\u003Cp\u003E\nO código fala por si mesmo: criamos um objeto novo para o arquivo XML, outro para o XSD, e pedimos para fazer a validação:\n\u003C\u002Fp\u003E\n\u003Cdiv class=\"codigo\"\u003E\n\u003Cpre\u003E\u003Ccode\u003E[taq@]$ ruby xsd.rb catalogo.xml catalogo.xsd \u003Cbr \u002F\u003Etrue\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003C\u002Fdiv\u003E\n\u003Cp\u003E\nOk! Tudo funcionando perfeitamente! Para fazer um pequeno teste, vou trocar o \u003Ctt\u003E2009\u003C\u002Ftt\u003E do arquivo XML para, sei lá, &#8220;homer&#8221;, e vamos rodar novamente:\n\u003C\u002Fp\u003E\n\u003Cdiv class=\"codigo\"\u003E\n\u003Cpre\u003E\u003Ccode\u003E[taq@]$ ruby xsd.rb catalogo.xml catalogo.xsd \u003Cbr \u002F\u003EError: Element 'catalogo', attribute 'ano': 'homer' is not a valid value of the\u003Cbr \u002F\u003Eatomic type 'xs:integer'. at catalogo.xml:2.\u003Cbr \u002F\u003Exsd.rb:6:in `validate_schema': Error: Element 'catalogo', attribute 'ano':\u003Cbr \u002F\u003E'homer' is not a valid value of the atomic type 'xs:integer'. at \u003Cbr \u002F\u003Ecatalogo.xml:2. (LibXML::XML::Error)\u003Cbr \u002F\u003Efrom xsd.rb:6\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003C\u002Fdiv\u003E\n\u003Cp\u003E\nA-há! Tivemos o comportamento esperado!\n\u003C\u002Fp\u003E\n\u003Cp\u003E\nUma das coisas do problema original era utilizar validação de algum elemento usando uma \u003Ca href=\"http:\u002F\u002Fpt.wikipedia.org\u002Fwiki\u002FExpress%C3%A3o_regular\" class=\"ext\"\u003Eexpressão regular\u003C\u002Fa\u003E. Vamos brincar um pouco com o nome do autor, dizendo que tem que ser composto por dois nomes \u003Cb\u003Eou\u003C\u002Fb\u003E a palavra &#8220;Desconhecido&#8221;. Para isso vamos mudar nosso arquivo XSD para:\n\u003C\u002Fp\u003E\n\u003Cdiv class=\"codigo\"\u003E\n\u003Cpre\u003E\u003Ccode\u003E &lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;\u003Cbr \u002F\u003E &lt;xs:schema xmlns:xs=\"\u003Ca href=\"http:\u002F\u002Fwww.w3.org\u002F2001\u002FXMLSchema\" class=\"ext\"\u003Ehttp:\u002F\u002Fwww.w3.org\u002F2001\u002FXMLSchema\u003C\u002Fa\u003E\"&gt;\u003Cbr \u002F\u003E    &lt;xs:element name=\"catalogo\"&gt;\u003Cbr \u002F\u003E       &lt;xs:complexType&gt;\u003Cbr \u002F\u003E          &lt;xs:sequence&gt;\u003Cbr \u002F\u003E             &lt;xs:element ref=\"categorias\" minOccurs=\"1\" maxOccurs=\"unbounded\"\u002F&gt;\u003Cbr \u002F\u003E          &lt;\u002Fxs:sequence&gt;\u003Cbr \u002F\u003E          &lt;xs:attribute name=\"loja\" type=\"xs:string\"\u002F&gt;\u003Cbr \u002F\u003E          &lt;xs:attribute name=\"ano\"  type=\"xs:integer\"\u002F&gt;\u003Cbr \u002F\u003E       &lt;\u002Fxs:complexType&gt;\u003Cbr \u002F\u003E    &lt;\u002Fxs:element&gt;\u003Cbr \u002F\u003E \u003Cbr \u002F\u003E    &lt;xs:element name=\"categorias\"&gt;\u003Cbr \u002F\u003E       &lt;xs:complexType&gt;\u003Cbr \u002F\u003E          &lt;xs:sequence&gt;\u003Cbr \u002F\u003E             &lt;xs:element ref=\"categoria\" minOccurs=\"1\" maxOccurs=\"unbounded\"\u002F&gt;\u003Cbr \u002F\u003E          &lt;\u002Fxs:sequence&gt;\u003Cbr \u002F\u003E       &lt;\u002Fxs:complexType&gt;\u003Cbr \u002F\u003E    &lt;\u002Fxs:element&gt;\u003Cbr \u002F\u003E \u003Cbr \u002F\u003E    &lt;xs:element name=\"categoria\"&gt;\u003Cbr \u002F\u003E       &lt;xs:complexType&gt;\u003Cbr \u002F\u003E          &lt;xs:sequence&gt;\u003Cbr \u002F\u003E             &lt;xs:element ref=\"livro\" minOccurs=\"1\" maxOccurs=\"unbounded\"\u002F&gt;\u003Cbr \u002F\u003E          &lt;\u002Fxs:sequence&gt;\u003Cbr \u002F\u003E          &lt;xs:attribute name=\"titulo\" type=\"xs:string\"\u002F&gt;\u003Cbr \u002F\u003E       &lt;\u002Fxs:complexType&gt;\u003Cbr \u002F\u003E    &lt;\u002Fxs:element&gt;\u003Cbr \u002F\u003E \u003Cbr \u002F\u003E    &lt;xs:element name=\"livro\"&gt;\u003Cbr \u002F\u003E       &lt;xs:complexType&gt;\u003Cbr \u002F\u003E          &lt;xs:sequence&gt;\u003Cbr \u002F\u003E             &lt;xs:element name=\"titulo\" type=\"xs:string\"\u002F&gt;\u003Cbr \u002F\u003E             &lt;xs:element ref=\"autor\" minOccurs=\"1\" maxOccurs=\"unbounded\"\u002F&gt;\u003Cbr \u002F\u003E          &lt;\u002Fxs:sequence&gt;\u003Cbr \u002F\u003E       &lt;\u002Fxs:complexType&gt;\u003Cbr \u002F\u003E    &lt;\u002Fxs:element&gt;\u003Cbr \u002F\u003E \u003Cbr \u002F\u003E    &lt;xs:element name=\"autor\"&gt;\u003Cbr \u002F\u003E       &lt;xs:simpleType&gt;\u003Cbr \u002F\u003E          &lt;xs:restriction base=\"xs:string\"&gt;\u003Cbr \u002F\u003E             &lt;xs:pattern value=\"&#92;w+ &#92;w+|Desconhecido\"\u002F&gt;\u003Cbr \u002F\u003E          &lt;\u002Fxs:restriction&gt;\u003Cbr \u002F\u003E       &lt;\u002Fxs:simpleType&gt;\u003Cbr \u002F\u003E    &lt;\u002Fxs:element&gt;\u003Cbr \u002F\u003E &lt;\u002Fxs:schema&gt;\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003C\u002Fdiv\u003E\n\u003Cp\u003E\nNotem as mudanças nas linhas 34 e da 39 até a 45 e brinquem um pouco com o arquivo XML.\n\u003C\u002Fp\u003E\n\u003Cp\u003E\nO &#92;w deve funcionar até para todos os caracteres\u003Cbr \u002F\u003E\nacentuados, mas se por acaso ocorrer algum caso muito específico onde\u003Cbr \u002F\u003E\nhouver a necessidade de deixar explícita alguma exceção do Unicode, ou\u003Cbr \u002F\u003E\nvocê estiver rodando a sua validação em algum lugar onde não tenha\u003Cbr \u002F\u003E\ncontrole dos softwares instalados e haja algum problema em relação à\u003Cbr \u002F\u003E\nlibxml com caracteres acentuados, algum problema de encoding dos\u003Cbr \u002F\u003E\narquivos etc. etc., podemos utilizar alguns \u003Ca href=\"http:\u002F\u002Funicode.org\u002Funicode\u002Freports\u002Ftr18\u002F\" class=\"ext\"\u003Epadrões bem documentados\u003C\u002Fa\u003E para contornar isso. Vamos supor que nosso arquivo XML fosse assim:\n\u003C\u002Fp\u003E\n\u003Cdiv class=\"codigo\"\u003E\n\u003Cpre\u003E\u003Ccode\u003E &lt;?xml version=\"1.0\"?&gt;\u003Cbr \u002F\u003E &lt;catalogo loja=\"Livraria O Quarto Homem\" ano=\"2009\"&gt;\u003Cbr \u002F\u003E    &lt;categorias&gt;\u003Cbr \u002F\u003E       &lt;categoria titulo=\"ficção\"&gt;\u003Cbr \u002F\u003E          &lt;livro&gt;\u003Cbr \u002F\u003E             &lt;titulo&gt;A Voz do Fogo&lt;\u002Ftitulo&gt;\u003Cbr \u002F\u003E             &lt;autor&gt;Alan Moore&lt;\u002Fautor&gt;\u003Cbr \u002F\u003E          &lt;\u002Flivro&gt;\u003Cbr \u002F\u003E       &lt;\u002Fcategoria&gt;\u003Cbr \u002F\u003E       &lt;categoria titulo=\"programação\"&gt;\u003Cbr \u002F\u003E          &lt;livro&gt;\u003Cbr \u002F\u003E             &lt;titulo&gt;Ruby: Conhecendo a Linguagem&lt;\u002Ftitulo&gt;\u003Cbr \u002F\u003E             &lt;autor&gt;Eustáquio Rangel&lt;\u002Fautor&gt;\u003Cbr \u002F\u003E          &lt;\u002Flivro&gt;\u003Cbr \u002F\u003E       &lt;\u002Fcategoria&gt;\u003Cbr \u002F\u003E    &lt;\u002Fcategorias&gt;\u003Cbr \u002F\u003E &lt;\u002Fcatalogo&gt;\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003C\u002Fdiv\u003E\n\u003Cp\u003E\nNotem o acento no nome desse quem vos escreve, na linha \u003Ctt\u003E13\u003C\u002Ftt\u003E. Agora vamos supor, para efeitos didáticos, que por alguma razão maluca não estamos utilizando o \u003Ctt\u003E&#92;w\u003C\u002Ftt\u003E na expressão para validar o nome do autor, sei lá, de repente ele não funciona, e sim algo do tipo:\n\u003C\u002Fp\u003E\n\u003Cdiv class=\"codigo\"\u003E\n\u003Cpre\u003E\u003Ccode\u003E &lt;xs:pattern value=\"[A-z]+ [A-z]+|Desconhecido\"\u002F&gt;\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003C\u002Fdiv\u003E\n\u003Cp\u003E\nO arquivo nunca seria validado:\n\u003C\u002Fp\u003E\n\u003Cdiv class=\"codigo\"\u003E\n\u003Cpre\u003E\u003Ccode\u003E[taq@]$ ruby xsd.rb catalogo.xml catalogo.xsd\u003Cbr \u002F\u003EError: Element 'autor': [facet 'pattern'] The value 'Eustáquio Rangel' is not \u003Cbr \u002F\u003Eaccepted by the pattern '[A-z]+ [A-z]+|Desconhecido'. at catalogo.xml:13.\u003Cbr \u002F\u003EError: Element 'autor': 'Eustáquio Rangel' is not a valid value of the local \u003Cbr \u002F\u003Eatomic type. at catalogo.xml:13.\u003Cbr \u002F\u003Exsd.rb:6:in `validate_schema': Error: Element 'autor': 'Eustáquio Rangel' is \u003Cbr \u002F\u003Enot a valid value of the local atomic type. at catalogo.xml:13. \u003Cbr \u002F\u003E(LibXML::XML::Error) from xsd.rb:6\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003C\u002Fdiv\u003E\n\u003Cp\u003E\nAí poderíamos ter escrito a expressão dessa maneira:\n\u003C\u002Fp\u003E\n\u003Cdiv class=\"codigo\"\u003E\n\u003Cpre\u003E\u003Ccode\u003E &lt;xs:pattern value=\"&#92;p{L}+ &#92;p{L}+|Desconhecido\"\u002F&gt;\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003C\u002Fdiv\u003E\n\u003Cp\u003E\nE o arquivo validaria de boa:\n\u003C\u002Fp\u003E\n\u003Cdiv class=\"codigo\"\u003E\n\u003Cpre\u003E\u003Ccode\u003E[taq@]$ ruby xsd.rb catalogo.xml catalogo.xsd\u003Cbr \u002F\u003Etrue\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003C\u002Fdiv\u003E\n\u003Cp\u003E\nO &#92;p{L} ali no caso representa um caractere na categoria &#8220;Letra&#8221; do Unicode, em qualquer língua. Mais \u003Ca href=\"http:\u002F\u002Fwww.regular-expressions.info\u002Funicode.html\" class=\"ext\"\u003Eum monte de exemplos de categorias do Unicode vocês podem encontrar aqui\u003C\u002Fa\u003E e podem ser uma mão na roda para alguma situação mais específica que possa aparecer.\u003C\u002Fp\u003E\n","excerpt":"","link":"https:\u002F\u002Fimasters.com.br\u002Fback-end\u002Fvalidando-xml-com-ruby","date":"20 abr, 2009","thumbnail":"","externalMention":null,"author":{"id":6965,"thumbnail":"https:\u002F\u002Fsecure.gravatar.com\u002Favatar\u002F36a7207dc8c3974a330919128af15cc9?s=96&d=mm&r=g","name":"Eustáquio Rangel","description":"é desenvolvedor Java, PHP e Ruby, que é seu principal foco desde 2004 e que lhe rendeu um livro.","slug":"eustaquio_rangel","url":"\u002Fperfil\u002Feustaquio_rangel","registered":"2009-02-10 17:47:52","social":{"linkedin":null,"youtube":null,"facebook":null,"twitter":null,"instagram":null,"github":null},"articles_count":12,"views_count":15192,"certifications":null,"conquests":null,"office":null},"categories":[{"title":"Back-End","slug":"back-end","id":7158,"link":"https:\u002F\u002Fimasters.com.br\u002Fback-end"},{"title":"Ruby","slug":"ruby","id":7231,"link":"https:\u002F\u002Fimasters.com.br\u002Flinguagens\u002Fruby"},{"title":"Ruby on Rails","slug":"ruby-on-rails","id":7292,"link":"https:\u002F\u002Fimasters.com.br\u002Fframework\u002Fruby-on-rails"},{"title":"XML","slug":"xml","id":7222,"link":"https:\u002F\u002Fimasters.com.br\u002Flinguagens\u002Fxml"}],"tags":[],"seo":{"open_graph":{"title":"Validando XML com Ruby - iMasters - We are Developers","description":"","type":"article","locale":"pt_BR","site_name":"iMasters - We are Developers","image":false,"modified_time":"2018-05-24T12:22:54-03:00","published_time":"2009-04-20T09:45:00-03:00"},"twitter":{"title":"Validando XML com Ruby - iMasters - We are Developers","description":"","type":"summary_large_image","image":false}},"type":"post"}]},"categories":[{"title":"Back-End","slug":"back-end","id":7158,"link":"https:\u002F\u002Fimasters.com.br\u002Fback-end"},{"title":"PHP","slug":"php","id":7224,"link":"https:\u002F\u002Fimasters.com.br\u002Flinguagens\u002Fphp"}],"tags":[{"title":"ORM","slug":"orm","id":1029,"link":"https:\u002F\u002Fimasters.com.br\u002Form"},{"title":"php","slug":"php-2","id":326,"link":"https:\u002F\u002Fimasters.com.br\u002Fphp-2"},{"title":"torm","slug":"torm","id":2231,"link":"https:\u002F\u002Fimasters.com.br\u002Ftorm"}],"seo":{"open_graph":{"title":"TORM: um ORM simples para PHP - iMasters - We are Developers","description":"Eustáquio conta como foi criar um ORMs em PHP que suprisse as suas necessidades para desenvolver um projeto utilizando PHP puro.","type":"article","locale":"pt_BR","site_name":"iMasters - We are Developers","image":false,"modified_time":"2018-05-23T22:43:14-03:00","published_time":"2013-10-10T09:00:36-03:00"},"twitter":{"title":"TORM: um ORM simples para PHP - iMasters - We are Developers","description":"Eustáquio conta como foi criar um ORMs em PHP que suprisse as suas necessidades para desenvolver um projeto utilizando PHP puro.","type":"summary_large_image","image":false}},"type":"post"}},"author":{"success":false,"isFetchingPagination":false,"maxPages":0,"page":1,"data":{}},"category":{"success":false,"data":{}},"categoryArticles":{"success":false,"isFetchingPagination":false,"maxPages":0,"page":1,"data":{}},"categoryMostRead":{"success":false,"data":{}},"home":{"success":false,"featured":[],"options":{"homeProducts":[]},"allCategories":{},"featuredArticles":{},"magazines":{"data":[]},"tv":{},"forums":[],"authorsRanking":{},"events":{},"certificatedUsers":[],"news":[]},"page":{"success":false,"data":{}},"schedule":{"success":false,"data":{}},"singleNews":{"success":false,"data":{}},"listNews":{"success":false,"isFetchingPagination":false,"maxPages":0,"page":1,"data":[]},"sponsors":{"success":true,"data":[]},"header":{"success":true,"menus":{"main":[{"ID":138755,"order":1,"parent":0,"title":"Back-End","url":"\u002Fback-end","attr":"package","target":"","classes":"package","xfn":"","description":"Tecnologias utilizadas no backend da aplicação","object_id":7158,"object":"category","type":"taxonomy","type_label":"Categoria","children":[]},{"ID":138756,"order":2,"parent":0,"title":"Mobile","url":"\u002Fmobile","attr":"package","target":"","classes":"package","xfn":"","description":"Conteúdos sobre Desenvolvimento Mobile nas plataformas iOS (iPhone e iPad) e Android.","object_id":4255,"object":"category","type":"taxonomy","type_label":"Categoria","children":[]},{"ID":139476,"order":3,"parent":0,"title":"Front End","url":"\u002Ffront-end","attr":"package","target":"","classes":"package","xfn":"","description":"Conteúdos sobre HTML5, CSS3, Javascript, JQuery, Web Standards e SEO.","object_id":7304,"object":"category","type":"taxonomy","type_label":"Categoria","children":[]},{"ID":138764,"order":4,"parent":0,"title":"DevSecOps","url":"\u002Fdevsecops","attr":"package","target":"","classes":"package","xfn":"","description":"","object_id":1,"object":"category","type":"taxonomy","type_label":"Categoria","children":[]},{"ID":139204,"order":5,"parent":0,"title":"Design & UX","url":"\u002Fdesign-ux","attr":"package","target":"","classes":"package","xfn":"","description":"Conteúdos sobre User Experience, Arquitetura de Informação, Usabilidade, Acessibilidade, Design Responsivo, Teoria do Design e Photoshop.","object_id":7252,"object":"category","type":"taxonomy","type_label":"Categoria","children":[]},{"ID":138759,"order":6,"parent":0,"title":"Data","url":"\u002Fdata","attr":"package","target":"","classes":"package","xfn":"","description":"Conteúdos sobre Banco de Dados Oracle, MySQL, SQL Server, MongoDB, DB2 e Postgre SQL, sobre BI e análise de dados.","object_id":16,"object":"category","type":"taxonomy","type_label":"Categoria","children":[]},{"ID":138758,"order":7,"parent":0,"title":"APIs e Microsserviços","url":"\u002Fapis-microsservicos","attr":"package","target":"","classes":"package","xfn":"","description":"Dicas e tutoriais sobre APIs públicas como Facebook, Twitter, PayPal, Buscapé, Google, etc e arquitetura de microsserviços, com códigos de exemplo, vídeos, cursos.","object_id":4257,"object":"category","type":"taxonomy","type_label":"Categoria","children":[]},{"ID":138760,"order":8,"parent":0,"title":"IoT e Makers","url":"\u002Fiot-makers","attr":"package","target":"","classes":"package","xfn":"","description":"","object_id":2901,"object":"category","type":"taxonomy","type_label":"Categoria","children":[]}],"secondary":[{"ID":138751,"order":1,"parent":0,"title":"Eventos","url":"https:\u002F\u002Feventos.imasters.com.br\u002F","attr":"","target":"_blank","classes":"","xfn":"","description":"","object_id":138751,"object":"custom","type":"custom","type_label":"Link personalizado","children":[]},{"ID":138752,"order":2,"parent":0,"title":"Fórum iMasters","url":"https:\u002F\u002Fforum.imasters.com.br\u002F","attr":"","target":"_blank","classes":"","xfn":"","description":"","object_id":138752,"object":"custom","type":"custom","type_label":"Link personalizado","children":[]},{"ID":138753,"order":3,"parent":0,"title":"Developer Store","url":"https:\u002F\u002Fimasters.shop\u002F","attr":"","target":"_blank","classes":"","xfn":"","description":"","object_id":138753,"object":"custom","type":"custom","type_label":"Link personalizado","children":[]},{"ID":138754,"order":4,"parent":0,"title":"Cursos Online","url":"https:\u002F\u002Fwww.alura.com.br\u002Fimasters","attr":"","target":"_blank","classes":"","xfn":"","description":"","object_id":138754,"object":"custom","type":"custom","type_label":"Link personalizado","children":[]},{"ID":138834,"order":5,"parent":0,"title":"7Masters","url":"https:\u002F\u002Fsetemasters.imasters.com.br\u002F","attr":"","target":"","classes":"","xfn":"","description":"","object_id":138834,"object":"custom","type":"custom","type_label":"Link personalizado","children":[]},{"ID":138835,"order":6,"parent":0,"title":"Revista Impressa","url":"https:\u002F\u002Fissuu.com\u002Fimasters\u002Fdocs\u002Fimasters_26_v6_isuu","attr":"","target":"","classes":"","xfn":"","description":"","object_id":138835,"object":"custom","type":"custom","type_label":"Link personalizado","children":[]},{"ID":139067,"order":7,"parent":0,"title":"Certificações","url":"http:\u002F\u002Fcertificacao.imasters.com.br","attr":"","target":"","classes":"","xfn":"","description":"","object_id":139067,"object":"custom","type":"custom","type_label":"Link personalizado","children":[]}]}},"webinar":{"success":false,"data":{}}}
    window.__SERVER_VARS__ = {"applicationRestUrl":"https:\u002F\u002Fadmin.imasters.com.br\u002Fwp-json","applicationBaseUrl":"https:\u002F\u002Fadmin.imasters.com.br"}</script><script src="TORM%20%20um%20ORM%20simples%20para%20PHP%20%20%20iMasters_arquivos/react-build.js"></script><script src="TORM%20%20um%20ORM%20simples%20para%20PHP%20%20%20iMasters_arquivos/vendor.js"></script><script src="TORM%20%20um%20ORM%20simples%20para%20PHP%20%20%20iMasters_arquivos/main.js" async=""></script><div id="fb-root" class=" fb_reset"><div style="position: absolute; top: -10000px; height: 0px; width: 0px;"><div><iframe name="fb_xdm_frame_https" allowtransparency="true" allowfullscreen="true" scrolling="no" allow="encrypted-media" id="fb_xdm_frame_https" aria-hidden="true" title="Facebook Cross Domain Communication Frame" tabindex="-1" style="border: medium none;" src="TORM%20%20um%20ORM%20simples%20para%20PHP%20%20%20iMasters_arquivos/mAiQUwlReIP.htm" frameborder="0"></iframe></div></div><div style="position: absolute; top: -10000px; height: 0px; width: 0px;"><div><iframe name="f8bab3cb90e074" allowtransparency="true" allowfullscreen="true" scrolling="no" allow="encrypted-media" style="display: none;" src="https://web.facebook.com/connect/ping?client_id=426457214062479&amp;domain=imasters.com.br&amp;origin=1&amp;redirect_uri=https%3A%2F%2Fstaticxx.facebook.com%2Fconnect%2Fxd_arbiter%2Fr%2FmAiQUwlReIP.js%3Fversion%3D42%23cb%3Dfd05b1b2688238%26domain%3Dimasters.com.br%26origin%3Dhttps%253A%252F%252Fimasters.com.br%252Ff2c723913f65fc4%26relation%3Dparent&amp;response_type=token%2Csigned_request%2Ccode&amp;sdk=joey&amp;version=v3.0" frameborder="0"></iframe></div></div></div><iframe id="google_osd_static_frame_4340200463911" name="google_osd_static_frame" style="display: none; width: 0px; height: 0px;"></iframe></body></html>